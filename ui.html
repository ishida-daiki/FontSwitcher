<style>
  /* Reset CSS */
  html,
  body,
  div,
  span,
  object,
  iframe,
  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  p,
  blockquote,
  pre,
  abbr,
  address,
  cite,
  code,
  del,
  dfn,
  em,
  img,
  ins,
  kbd,
  q,
  samp,
  small,
  strong,
  sub,
  sup,
  var,
  b,
  i,
  dl,
  dt,
  dd,
  ol,
  ul,
  li,
  fieldset,
  form,
  label,
  legend,
  table,
  caption,
  tbody,
  tfoot,
  thead,
  tr,
  th,
  td,
  article,
  aside,
  canvas,
  details,
  figcaption,
  figure,
  footer,
  header,
  hgroup,
  menu,
  nav,
  section,
  summary,
  time,
  mark,
  audio,
  video {
    margin: 0;
    padding: 0;
    border: 0;
    outline: 0;
    font-size: 100%;
    vertical-align: baseline;
    background: transparent;
    list-style: none;
  }
  body {
    margin: 0;
    background-color: var(--figma-color-bg);
    color: var(--figma-color-text);
    font-family: "Inter";
    font-size: 11px;
    font-weight: 400;
    width: 100%;
    overflow-y: hidden;
    display: flex;
    flex-direction: column;
  }
  /* メニューが開いている間はhoverスタイルを無効にする */
  body.menu-open .apply-style__item:hover,
  body.menu-open .options-button:hover {
    outline: none;
    background: none;
  }
  /* Webkitベースのブラウザ用 */
  .scrollbar-hidden::-webkit-scrollbar {
    display: none; /* スクロールバーを非表示 */
  }

  /* Firefox用 */
  .scrollbar-hidden {
    scrollbar-width: none; /* Firefoxではこれでスクロールバーを非表示にできる */
  }

  /* IEおよびEdgeレガシーブラウザ用 */
  .scrollbar-hidden {
    -ms-overflow-style: none; /* 古いIEとEdge用 */
  }
  svg {
    display: block;
  }
  .main {
    width: 324px;
    border-right: 1px solid var(--figma-color-border);
    flex: 1;
    position: relative;
  }
  .overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 9;
  }
  .tab-list {
    position: relative;
    border-bottom: 1px var(--figma-color-border) solid;
    padding-left: 1rem;
    padding-right: 1rem;
    height: 40px;
  }
  .tab-list__items {
    display: flex;
    gap: 8px;
    color: var(--figma-color-text-onselected);
    height: 100%;
  }
  .tab-list__item {
    display: flex;
    align-items: center;
    margin-right: 0.5rem;
    cursor: default;
    height: 100%;
    color: var(--figma-color-text-secondary);
  }
  .tab-list__item:hover {
    color: var(--figma-color-text);
  }
  .tab-edit {
    position: relative;
    border-bottom: 1px var(--figma-color-border) solid;
    padding-left: 12px;
    padding-right: 1rem;
    height: 40px;
    display: flex;
    gap: 8px;
    align-items: center;
  }
.tab-list__edit-text {
    font-size: 11px;
    font-weight: 500;
    color: var(--figma-color-text);
  }
  .tab-list__text {
    font-size: 11px;
    font-weight: 500;
  }
  /* 選択されたタブのテキストスタイル */
  .tab-list__item--active .tab-list__text {
    /* 太字にする */
    font-weight: 600;
    color: var(--figma-color-text);
  }
  /* 選択インジケーターのスタイル */
  .tab-list-active-indicator {
    height: 2px;
    width: 100%;
    border-radius: 6px;
    position: absolute;
    bottom: -1px;
    left: 0;
  }
  /* 非アクティブなタブを隠す */
  .tab-list-active-indicator--inactive {
    display: none;
  }
  .create-style__apply-button {
    padding: 0.8rem 1.5rem;
    margin: 8 16 16 16px;
    border-radius: 6px;
    font-weight: 600;
  }
  .create-style__apply-button.disabled {
    border: var(--figma-color-border-disabled);
    color: var(--figma-color-text-disabled);
    background: var(--figma-color-bg-disabled);
  }
  .create-style__apply-button.active {
    border: var(--figma-color-border-selected);
    color: var(--figma-color-text-onbrand);
    background: var(--figma-color-bg-brand);
  }
  .create-style__apply-button.active:hover {
    cursor: default;
    border: var(--figma-color-border-selected);
    background: var(--figma-color-bg-brand-hover);
  }
  .create-style__apply-button.active:active {
    color: var(--figma-color-text-onbrand);
    background: var(--figma-color-bg-brand-pressed);
  }
  .apply-style {
    display: flex;
    flex-direction: column;
  }
  .create-style {
    display: flex;
    flex-direction: column;
  }
  .edit-style {
    display: flex;
    flex-direction: column;
  }
  .error {
    color: var(--figma-color-text-danger);
  }
  .apply-style__text {
    color: var(--figma-color-text-disabled);
    font-weight: 400;
  }
  .apply-style__content {
    display: flex;
    flex-direction: column;
    padding: 8 0px;
  }
  .create-style__content {
    display: flex;
    flex-direction: column;
    padding: 8 0px;
  }
  .apply-style__title {
    font-weight: 600;
    line-height: 16px;
    letter-spacing: 0.06px;
  }
  .create-style__tab-title {
    font-weight: 600;
    line-height: 16px;
    letter-spacing: 0.06px;
  }
  .apply-style__item-content {
    display: flex;
    justify-content: space-between;
    cursor: default;
    padding: 0 8px;
    border-radius: 2px;
    align-items: center;
    height: 30px;
    flex-grow: 2;
  }
  .apply-style__list__container {
    position: relative;
  }
  .apply-style__list {
    display: flex;
    flex-direction: column;
    position: relative;
    height: 200px;
    overflow-y: hidden;
  }
  .apply-style__item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: relative;
    box-sizing: border-box;
    outline: 1px solid transparent;
    outline-offset: -1px;
    min-height: 40px;
    padding: 0 8px;
  }
  .apply-style__item:hover {
    outline: 1px solid var(--figma-color-border-selected, #0c8ce9);
    opacity: 1;
  }
  .apply-style__item:focus-visible {
    background: var(--figma-color-bg-selected);
    color: var(--figma-color-text);
  }
  .apply-style__item.active {
    background: var(--figma-color-bg-selected, rgba(0, 0, 0, 0.06));
    outline: 1px solid transparent;
  }
  .apply-style__item.active .options-button:hover {
    background: var(--figma-color-bg-selected-hover, rgba(0, 0, 0, 0.06));
  }
  .apply-style__item-title {
    color: var(--figma-color-text);
    font-weight: 400;
    letter-spacing: 0.055px;
  }
  .options-button {
    right: 8;
    border: 1px solid transparent;
    outline: none;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 32px;
    width: 32px;
    flex: 0 0 32px;
    cursor: default;
    background-clip: padding-box;
    background-color: transparent;
    transition: 0.1s fill ease-out, 0.1s color ease-out;
    border-radius: 3px;
  }
  .options-button:hover {
    background: var(--figma-color-bg-hover, rgba(0, 0, 0, 0.06));
  }
  .options-button.active {
    background: var(--figma-color-bg-brand, #0d99ff);
  }
  .options-button.active .apply-style__options-svg {
    fill: var(--figma-color-icon-onbrand);
  }
  /* ボタンがホバーされた時にポップアップを表示する */
  .options-button:hover + .popup {
    display: block;
  }

  .options-button.active ~ .menu {
    display: block; /* アクティブな状態のボタンの兄弟要素であるmenuを表示 */
  }
  .options-button.active .popup {
    background: var(--figma-color-bg-brand, #0d99ff);
  }
  .options-button.active .sample-style__options-svg {
    fill: var(--figma-color-icon-onbrand);
  }
  /* ポップアップコンテナ (Element) */
  .popup {
    position: absolute;
    bottom: -34px;
    right: 8px;
    display: none;
    z-index: 100;
    border-radius: 2px;
    z-index: 10;
  }
  .popup.edit {
    right: 40px;
  }
  .popup.delete {
    right: 8px;
  }
  .popup.create {
    right: 8px;
  }

  /* ポップアップコンテナ (Element Modifier) */
  .popup:hover {
    display: block;
  }

  /* ポップアップアローのコンテナ (Element) */
  .popup-arrow-container {
    position: relative;
  }
  /* ポップアップの内容 (Element) */
  .popup-content {
    height: 28px;
    background: #222222;
    color: #ffffff;
    box-shadow: 0px 2px 7px rgba(0, 0, 0, 0.15);
    padding: 0 8px;
    display: flex;
    align-items: center;
    border-radius: 2px;
  }
  /* ポップアップアロー (Element) */
  .popup-arrow {
    position: absolute;
    top: -6px;
    right: 10;
  }

  .scroll_container--track--HEzfy {
    position: absolute;
    right: 0;
    top: 0;
    bottom: 0;
    width: 6px;
    padding: 2px;
    cursor: default;
    z-index: 7;
  }
  .scroll_container--scrollBar--YLWIi {
    display: none;
    position: absolute;
    width: 6px;
    right: 2px;
    top: 0;
  }
  .scroll_container--scrollBar--YLWIi:after {
    content: "";
    position: absolute;
    inset: 2px 0;
    width: 100%;
    border-radius: 6px;
    background: rgba(179, 179, 179, 0.5);
    transition: transform 0.2s ease-in-out;
  }

  .apply-style__message {
    display: grid;
    place-content: center;
    height: 96px;
    background-color: var(--figma-color-bg-secondary);
    padding: 0 16px;
    line-height: 1.5;
    border-bottom: 1px var(--figma-color-border) solid;
    overflow: hidden;
  }
  .center {
    text-align: center;
  }
  .text {
    padding-top: 1px;
    color: var(--figma-color-text-disabled);
    pointer-events: none;
  }
  .apply-style__options-svg {
    fill: var(--figma-color-icon);
  }
  /* ローディングインジケーターのスタイル */
  .loading-indicator {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--figma-color-bg-inverse);
    display: flex;
    flex-direction: column;
    align-content: center;
    align-items: center;
    opacity: 95%;
  }
  .progress-ring {
    width: 240px;
    height: 240px;
  }
  .progress-ring__circle {
    transition: stroke-dashoffset 0.35s;
    transform: rotate(-90deg);
    transform-origin: 50% 50%;
  }
  .progress-text {
    color: var(--figma-color-text-oninverse);
  }
  .select-content {
    display: flex;
  }

  /* Additional styles for 'select' dropdown */
  .select-container {
    position: relative;
    margin-bottom: 10px;
  }

  .select-dropdown {
    padding: 4px;
    border: 1px solid var(--figma-color-border);
    background-color: var(--figma-color-bg);
    border-radius: 4px;
    width: 100%;
    font-family: "Inter", sans-serif;
    font-size: 11px;
    cursor: default;
    appearance: none; /* Disables the native drop-down arrow */
  }

  .select-dropdown:focus {
    outline: none;
    border-color: var(--figma-color-border-focus);
  }

  /* Style for custom dropdown arrow */
  .select-arrow {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none; /* Makes sure the svg does not prevent clicking the select box */
  }

  .select-arrow svg {
    fill: var(--figma-color-icon); /* Icon color */
  }

  .create-style.font-family {
    display: flex;
    flex-direction: column;
    max-height: 295px;
    top: calc(100% + 1px);
    -webkit-font-smoothing: antialiased;
    pointer-events: none;
    background-color: #1e1e1e;
    border-radius: var(--border-radius-2);
    box-shadow: var(--box-shadow-menu);
    color: #fff;
    font-size: var(--font-size-12);
    left: 0;
    min-width: 100%;
    overflow-y: auto;
    padding: var(--space-extra-small) 0;
    position: absolute;
  }
  .font-family_label {
    position: relative;
    padding: 4px var(--space-medium) 4px 32px;
    text-overflow: ellipsis;
    white-space: nowrap;
    display: block;
  }

  .font-family_labelText {
    display: block;
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    height: 100%;
    width: 100%;
  }

  .create-style__font-menu {
    background: var(--figma-color-bg);
    box-shadow: 0px 5px 17px rgba(0, 0, 0, 0.2);
    border-radius: 2px;
    z-index: 100;
    overflow-y: auto;
  }
  .create-style__font-menu.font-family-list-container {
    position: absolute;
    right: 16px;
    left: 16px;
    top: 16px;
    bottom: 16px;
    display: flex;
    flex-direction: column;
    max-height: 431px;
    border-radius: 3px;
  }
  .create-style__font-menu.font-family-list-container.hidden {
    display: none;
  }
  .create-style__font-menu.font-weight-list-container {
    position: absolute;
    right: 0px;
    width: 200px;
    padding-top: 8px;
    padding-bottom: 8px;
    max-height: 230px;
    overflow-x: hidden;
    background: rgb(34, 34, 34);
    bottom: -40px;
    border-radius: 3px;
  }

  .scroll_container > .font-menu__item {
    width: 100%;
    min-height: 28px;
    position: relative;
    display: flex;
    align-items: center;
  }
  .scroll_container > .font-menu__item:hover {
    background: var(--figma-color-bg-hover);
  }
  .font-menu__item {
    width: 100%;
    min-height: 24px;
    position: relative;
    display: flex;
    align-items: center;
  }
  .font-menu__item:hover {
    background: #18a0fb;
  }
  .font-menu__divider {
    width: 100%;
    height: 17px;
    position: relative;
    display: flex;
    align-items: center;
  }
  .font-menu__divider__item {
    position: absolute;
    display: flex;
    align-items: center;
    width: 100%;
    left: 0;
    background: #4E4E4E;
    height: 1px;
    top: 50%;
  }
  .menu {
    width: 178px;
    padding-top: 8px;
    padding-bottom: 8px;
    background: #222222;
    box-shadow: 0px 5px 17px rgba(0, 0, 0, 0.2);
    border-radius: 2px;
    color: var(--figma-color-text-onbrand);
    position: absolute;
    right: 8px;
    max-height: 164px;
    overflow-y: auto;
    display: none;
    z-index: 10;
    top: 40px;
  }

  .menu__item {
    height: 24px;
    position: relative;
    display: flex;
    align-items: center;
    padding: 0 16px;
  }
  .menu__item:hover {
    background: #18a0fb;
  }
  .menu__item__divider {
    height: 17px;
    position: relative;
    display: flex;
    align-items: center;
  }
  .menu__divider {
    position: absolute;
    height: 1px;
    width: 100%;
    left: 0px;
    background: rgba(255, 255, 255, 0.2);
  }

  .font-menu__item__icon {
    position: absolute;
    left: 8px;
    width: 20px;
    height: 16px;
  }

  .font-menu__divider {
    width: 100%;
    height: 17px;
    position: relative;
    display: flex;
    align-items: center;
  }
  .font-menu__divider_item {
    width: 100%;
    border: 1px rgba(255, 255, 255, 0.2) solid;
  }

  .font-menu__text {
    display: flex;
    align-items: center;
    width: 100%;
    height: 100%;
    left: 32px;
    top: 0px;
    position: absolute;
    color: var(--figma-color-text);
    font-size: 12px;
    font-family: Inter;
    font-weight: 400;
    line-height: 16px;
    letter-spacing: 0.06px;
    word-wrap: break-word;
  }
  .font-menu__text.sample {
    color: #ffffff;
  }
  .font-menu__text.font-weight {
    color: #ffffff;
  }

  .font-menu__icon {
    width: 16px;
    height: 16px;
    left: 8px;
    top: 4px;
    position: absolute;
  }
  .font-menu__icon.font-family {
    top: 6px;
  }

  .font-menu__icon-img {
    width: 9.91px;
    height: 7.62px;
    left: 3.29px;
    top: 3.79px;
    position: absolute;
  }
  /* 非表示にするためのクラス */
  .hidden {
    display: none;
  }
  /* ルート要素 (Block) */
  .apply-style__styles {
    height: 32px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: relative;
    padding: 0 8 0 16px;
  }
  /* ルート要素 (Block) */
  .create-style__tab-header {
    height: 32px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: relative;
    padding: 0 8 0 16px;
  }
  /* ルート要素 (Block) */
  .create-style__styles {
    height: 32px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: relative;
    padding: 0 8 0 16px;
    color: var(--figma-color-text-secondary);
    font-weight: 500;
  }
  /* Dropdown Component Styles */
  .create-style__dropdown {
    /* スタイルシートのリセットや追加のスタイリングが必要な場合はここに記述 */
    display: flex;
    margin: 0 16 0 8px;
    align-items: flex-start;
  }

  .create-style__dropdown-toggle {
    font-size: 11px;
    display: flex;
    align-items: center;
    padding-right: 4px;
    color: var(--figma-color-text, #333333);
    fill: var(--figma-color-icon, #333333);
    border-radius: 2px;
    cursor: default;
    box-sizing: border-box;
    background-clip: padding-box;
    height: 28px;
    border: 1px solid transparent;
    border-radius: 2px;
    position: relative;
    box-sizing: border-box;
    margin-top: 1px;
    padding: 0 4 0 8px;
    margin: 1 0px;
    background: transparent;
  }
  .create-style__dropdown-toggle.font-weight {
    flex-grow: 1;
    appearance: none; /* ブラウザデフォルトのスタイルを解除 */
  }

  .create-style__dropdown-toggle.font-family:hover,
  .create-style__dropdown-toggle.font-family:active {
    /* ホバーやフォーカス時の追加スタイル。例えば背景色を変更するなど */
    background: var(--figma-color-bg-hover);
  }
  .create-style__dropdown-toggle.font-family:focus-visible {
    border: 2px solid var(--figma-color-border-selected);
  }
  .create-style__dropdown-toggle.font-weight:hover,
  .create-style__dropdown-toggle.font-weight:active {
    border: 1px solid var(--figma-color-border, rgba(0, 0, 0, 0.1));
    justify-content: space-between;
  }

  .create-style__dropdown-label {
    max-width: calc(100% - 12px); /* アイコンの幅を考慮した幅を設定 */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .create-style__dropdown-icon-container {
    width: 16px;
    flex: 0 0 16px;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    color: var(--figma-color-icon-disabled);
    fill: var(--figma-color-icon-disabled);
  }

  .create-style__dropdown-icon {
    width: 16px; /* SVGの大きさを指定 */
    margin-left: auto; /* アイコンを右寄せする */
  }
  .create-style__dropdown-group.font-family {
    display: flex;
    flex-direction: column;
    flex-grow: 3;
    width: 180px;
  }
  .create-style__dropdown-group.font-weight {
    display: flex;
    flex-direction: column;
    flex-grow: 1;
    width: 120px;
    position: relative;
  }
  .create-style__input-groups {
    display: flex;
    flex-direction: column;
    gap: 8px;
    border-bottom: 1px solid var(--figma-color-border);
    padding: 16px 0px;
  }
  .create-style__input-group {
    box-sizing: border-box;
    width: 100%;
    height: max-content;
    background-color: transparent;
    display: flex;
    flex-direction: row;
    -webkit-box-pack: justify;
    justify-content: space-between;
    align-items: flex-start;
    padding: 0px 16px;
    gap: 16px;
  }
  .create-style__label {
    -webkit-user-select: none;
    user-select: none;
    text-align: left;
    color: var(--figma-color-text, #333333);
    fill: var(--figma-color-icon, #333333);
    border-radius: 2px;
    cursor: default;
    box-sizing: border-box;
    background-clip: padding-box;
    display: flex;
    align-items: center;
    height: 28px;
    width: 84px;
  }
  .create-style__input {
    grid-column-start: 1;
    padding: 0 8px;
    margin: 1 0px;
    border: 1px solid var(--figma-color-border);
    width: calc(100% - 96px);
    background-color: var(--color-bg);
    grid-column-end: span 28;
    color: var(--figma-color-text);
    fill: var(--figma-color-icon);
    border-radius: 2px;
    cursor: default;
    box-sizing: border-box;
    background-clip: padding-box;
    height: 28px;
    font-size: 11px;
    border-radius: 2px;
  }
  .create-style__input:focus-visible {
    height: 30px;
    margin-top: 0;
    margin-bottom: 0;
    border: 1px solid var(--figma-color-border-selected, #0d99ff);
    outline: 1px solid var(--figma-color-border-selected, #0d99ff);
    outline-offset: -2px;
  }
  .create-style__submit-button {
    color: var(--figma-color-text-onbrand, #fff);
    background-color: var(--figma-color-bg-brand);
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    height: 32px;
    line-height: 32px;
    max-width: 200px;
    padding: 0 12px;
    border-radius: 6px;
    -moz-outline-radius: 6px;
    cursor: default;
    -webkit-user-select: none;
    user-select: none;
  }
  .create-style__submit-button:hover,
  .update-button:hover {
    background-color: var(--figma-color-bg-brand-hover);
  }
  .update-button {
    color: var(--figma-color-text-onbrand, #fff);
    background-color: var(--figma-color-bg-brand);
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    height: 32px;
    line-height: 32px;
    max-width: 200px;
    padding: 0 12px;
    border-radius: 6px;
    -moz-outline-radius: 6px;
    cursor: default;
    -webkit-user-select: none;
    user-select: none;
  }
  .create-style__form-action {
    box-sizing: border-box;
    mix-blend-mode: normal;
    overflow: hidden;
    position: relative;
    padding: 16px;
    display: flex;
    flex-direction: row;
    -webkit-box-pack: justify;
    justify-content: space-between;
    -webkit-box-align: center;
    align-items: center;
    border-top: 1px solid var(--figma-color-border);
  }
  .update__form-action {
    box-sizing: border-box;
    mix-blend-mode: normal;
    overflow: hidden;
    position: relative;
    padding: 16px;
    display: flex;
    flex-direction: row;
    -webkit-box-pack: justify;
    justify-content: space-between;
    -webkit-box-align: center;
    align-items: center;
    border-top: 1px solid var(--figma-color-border);
  }
  .create-style__tabs {
    padding: 8 0px;
    display: flex;
    flex-direction: column;
  }
  input::placeholder {
    color: var(
      --figma-color-text-tertiary,
      #0000004d
    ); /* 好きな薄い色に変更してください */
    opacity: 1; /* 不透明度を設定することもできます（必須ではありません） */
  }

  .font_picker--fontPickerSearchRow--PBwi7 {
    color: var(--figma-color-icon);
    padding-left: 16px;
    padding-right: 8px;
    min-height: 40px;
    display: flex;
    align-items: center;
    border-bottom: 1px solid var(--figma-color-border);
  }
  .font_picker--searchIcon--ADEyj {
    padding-right: 2px;
    fill: var(--figma-color-icon);
  }
  .font_picker--fontPickerSearchBar--XigbT {
    margin-left: 8px;
    margin-right: 5px;
    width: 100%;
  }
  .font_picker--fontPickerSearchBarInput--qOPld {
    font-weight: 400;
    width: 100%;
    background-color: var(--figma-color-bg);
    color: var(--figma-color-text);
    height: 15px;
    border: none;
    padding: 0px;
  }
  .font_picker--fontPickerSearchBarInput--qOPld:focus {
    outline: 0px;
  }
  .scroll_container {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    overflow-y: auto;
    overflow-x: hidden;
  }
  .sample-style__container {
    display: flex;
    flex: 1;
    position: relative;
  }
  .sample-style__message {
    display: grid;
    place-content: center;
    background-color: var(--figma-color-bg-secondary);
    padding: 0 16px;
    line-height: 1.5;
    border-bottom: 1px var(--figma-color-border) solid;
    font-weight: 400;
    color: var(--figma-color-text-disabled);
    overflow: auto;
    flex: 1;
    max-height: 217px;
  }
  .sample-style__text {
    line-height: 180%;
    font-size: 1rem;
    overflow-wrap: break-word; /* 長い単語をコンテナ内で折り返す */
    word-break: break-word; /* 古いブラウザの互換性のため */
  }
  .sample-style__tab-header {
    height: 40px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: relative;
    padding: 0 8 0 16px;
    border-bottom: 1px solid var(--figma-color-border);
  }
  .sample-text-container {
    width: 324px;
    display: none;
    flex-direction: column;
    justify-content: space-between;
    flex: 1;
  }
  .sample-text__input-group {
    box-sizing: border-box;
    padding: 8 0 16 0px;
    width: 100%;
    height: max-content;
    background-color: transparent;
    display: flex;
    flex-direction: column;
    -webkit-box-pack: justify;
    justify-content: space-between;
    align-items: flex-start;
    border-bottom: 1px solid var(--figma-color-border);
    flex: 1;
  }
  .sample-style__input {
    grid-column-start: 1;
    padding: 4 8px;
    border: 1px solid var(--figma-color-border);
    background-color: var(--color-bg);
    grid-column-end: span 28;
    color: var(--figma-color-text);
    fill: var(--figma-color-icon);
    cursor: default;
    box-sizing: border-box;
    background-clip: padding-box;
    font-family: Inter;
    font-size: 11px;
    line-height: 175%;
    border-radius: 2px;
    width: -webkit-fill-available;
    height: 82px;
    resize: none;
    flex: 1;
  }
  .sample-style__input.scale {
    width: 46px;
    height: auto;
  }
  .sample-style__input::placeholder {
    color: var(--figma-color-text-disabled, #0000004d);
  }

  .sample-style__input:focus-visible {
    margin-top: 0;
    margin-bottom: 0;
    border: 1px solid var(--figma-color-border-selected, #0d99ff);
    outline: 1px solid var(--figma-color-border-selected, #0d99ff);
    outline-offset: -2px;
  }
  .sample-style__label {
    -webkit-user-select: none;
    user-select: none;
    text-align: left;
    color: var(--figma-color-text, #333333);
    fill: var(--figma-color-icon, #333333);
    border-radius: 2px;
    cursor: default;
    box-sizing: border-box;
    background-clip: padding-box;
  }
  .sample-style__content {
    display: flex;
    flex-direction: column;
  }
  .sample-style__tabs {
    display: flex;
    flex-direction: column;
    flex: 1;
  }
  .sample-language-menu {
    position: absolute;
    top: 46px;
    right: 8px;
    width: 178px;
    padding-top: 8px;
    padding-bottom: 8px;
    max-height: 164px;
    background: rgb(34, 34, 34);
    box-shadow: 0px 5px 17px rgba(0, 0, 0, 0.2);
    border-radius: 2px;
    z-index: 100;
  }
  .component-rows {
    display: flex;
    flex-direction: column;
    padding: 4 0px;
  }
  .component-row {
    display: flex;
    flex-direction: row;
    /* grid-template-columns: repeat(28, 1fr);
    grid-template-rows: 32px; */
    padding: 4 8 4 16px;
    position: relative;
    box-sizing: border-box;
    color: var(--figma-color-text, #333333);
    fill: var(--figma-color-icon, #333333);
    border-radius: 2px;
    cursor: default;
    background-clip: padding-box;
    gap: 12px;
    align-items: center;
  }
  .component-row__label {
    display: flex;
    align-items: center;
    width: 30px;
  }

  .component-row__slider {
    grid-column-start: 14;
    grid-column-end: span 28;
    display: flex;
    align-items: center;
    height: 30px;
    flex: 1;
  }

  .slider {
    width: 100%;
    position: relative;
    z-index: 1;
  }

  .slider__clip-container {
    position: relative;
    height: 100%;
  }

  .slider__track {
    position: absolute;
    top: calc(var(--slider-thumb-size, 9px) * 1 + 5.5px); /* 引数を簡素化 */
    height: 1px;
    width: 100%;
    cursor: default;
    background: #b3b3b3; /* 色指定の重複を排除 */
  }

  .slider__tick {
    position: absolute;
    height: 9px;
    pointer-events: none;
    top: calc(6px + 9px / 2);
    left: -1px;
    width: 1px;
    background: var(--bg-slider-track);
  }

  .slider__thumb {
    background: #fff;
    display: block;
    position: absolute;
    border: 1px solid #000;
    height: 9px;
    width: 9px;
    top: calc(var(--slider-thumb-size, 9px) / 2 + 6px);
    border-radius: 50%;
    box-sizing: border-box;
    left: -5px;
  }
</style>

<body class="scrollbar-hidden">
  <div id="overlay" class="overlay hidden"></div>
  <div style="display: flex; flex-direction: row;">
    <div class="main">
      <div class="apply-styles-container">
        <!-- tab-list -->
        <div class="tab-list">
          <ul class="tab-list__items">
            <li class="tab-list__item">
              <span class="tab-list__text">Apply styles</span>
            </li>
            <li class="tab-list__item">
              <span class="tab-list__text">Create style</span>
            </li>
          </ul>
          <div class="tab-list-active-indicator"></div>
        </div>
      
        <!-- Apply style  -->
        <div class="apply-style">
          <!-- 要素選択 -->
          <div class="apply-style__message">
            <p class="apply-style__text">
              Select the element whose <br />
              text you want to change
            </p>
          </div>
          <!-- 登録したテキストスタイル一覧 -->
          <div class="apply-style__content">
            <div class="apply-style__styles">
              <h2 class="apply-style__title">Style list</h2>
              <button
                class="options-button create"
                tabindex="0"
                aria-label="その他のオプション"
                data-tooltip-type="text"
                data-tooltip="その他のオプション"
              >
                <span class="apply-style__options-svg-container">
                  <svg
                    class="apply-style__options-svg"
                    width="12"
                    height="12"
                    viewBox="0 0 12 12"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      fill-rule="nonzero"
                      stroke="none"
                      d="M5 5V0h1v5h5v1H6v5H5V6H0V5h5z"
                      fill-opacity="1"
                    />
                  </svg>
                </span>
              </button>
              <div class="popup create">
                <div class="popup-arrow-container">
                  <div class="popup-content">Create style</div>
                  <div class="popup-arrow">
                    <svg
                      width="13"
                      height="7"
                      viewBox="0 0 13 7"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path d="M6.5 0L13 6.5H0L6.5 0Z" fill="#222222" />
                    </svg>
                  </div>
                </div>
              </div>
            </div>
      
            <div class="apply-style__list__container">
              <ul class="apply-style__list">
              </ul>
              <div class="scroll_container--track--HEzfy" role="none">
                <div
                  class="scroll_container--scrollBar--YLWIi"
                  role="none"
                  style="transform: translate3d(0px, 0px, 0px); height: 186.397px"
                ></div>
              </div>
            </div>
          </div>
          <!-- 反映ボタン -->
          <button id="applyBtn" class="create-style__apply-button disabled">
            Apply
          </button>
        </div>
      
        <!-- ローディングインジケーター -->
        <div id="loadingIndicator" class="loading-indicator hidden">
          <svg class="progress-ring" viewBox="0 0 240 240">
            <circle
              class="progress-ring__circle"
              stroke="var(--figma-color-bg-component)"
              stroke-width="10"
              fill="transparent"
              r="52"
              cx="120"
              cy="120"
            />
          </svg>
          <span class="progress-text">Applying fonts...</span>
        </div>
      </div>
    
      <div class="create-style-container">
        <!-- Create style  -->
        <div class="create-style hidden">
          <!-- スタイル名 作成 -->
          <div class="create-style__input-groups">
            <div class="create-style__input-group">
              <label class="create-style__label" for="styleNameInput"
                >Style name</label
              >
              <input
                type="text"
                id="styleNameInput"
                spellcheck="false"
                class="create-style__input"
                name="styleName"
                placeholder="New style"
                autocomplete="off"
                dir="auto"
                value
              />
            </div>
          </div>
    
          <div class="create-style__tabs">
            <div class="create-style__tab-header">
              <h2 class="create-style__tab-title">Settings</h2>
            </div>
            <div class="create-style__content">
              <div class="create-style__styles" id="mainView">
                <h2 class="create-style__tab-title">English</h2>
              </div>
              <div class="create-style__dropdown" data-lang="English">
                <div class="create-style__dropdown-group font-family">
                  <button
                    class="create-style__dropdown-toggle font-family"
                    data-label-type="font-family"
                    data-lang="English"
                  >
                    <span class="create-style__dropdown-label" data-lang='English'>SF Pro</span>
                  </button>
                  <div
                    class="create-style__font-menu hidden font-family-list-container"
                    role="menu"
                  >
                    <div class="font_picker--fontPickerSearchRow--PBwi7">
                      <span class="svg-container font_picker--searchIcon--ADEyj"
                        ><svg
                          class="svg"
                          xmlns="http://www.w3.org/2000/svg"
                          width="11"
                          height="11"
                          viewBox="0 0 11 11"
                        >
                          <path
                            fill-opacity="1"
                            fill-rule="evenodd"
                            stroke="none"
                            d="M6.453 7.16C5.776 7.687 4.924 8 4 8 1.79 8 0 6.21 0 4c0-2.21 1.79-4 4-4 2.21 0 4 1.79 4 4 0 .924-.314 1.776-.84 2.453l3.194 3.193-.708.707L6.453 7.16zM7 4c0 1.657-1.343 3-3 3-1.657 0-3-1.343-3-3 0-1.657 1.343-3 3-3 1.657 0 3 1.343 3 3z"
                          ></path></svg
                      ></span>
                      <div class="font_picker--fontPickerSearchBar--XigbT">
                        <input
                          placeholder="Search fonts"
                          spellcheck="false"
                          class="font-search font_picker--fontPickerSearchBarInput--qOPld lazy_input--lazyInput--Ltb6r"
                          type="text"
                          data-testid="font-picker-search-input"
                          dir="auto"
                          value=""
                        />
                      </div>
                      <button class="options-button close" tabindex="0" aria-label="その他のオプション" data-tooltip-type="text" data-tooltip="その他のオプション">
                        <span class="apply-style__options-svg-container">
                          <svg class="apply-style__options-svg" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="nonzero" stroke="none" d="m6 5.293 4.789-4.79.707.708-4.79 4.79 4.79 4.789-.707.707-4.79-4.79-4.789 4.79-.707-.707L5.293 6 .502 1.211 1.21.504 6 5.294z" fill-opacity="1"></path>
                          </svg>
                        </span>
                      </button>
                    </div>
                    <div class="scroll_container"></div>
                    <!-- Figmaにインストールされたフォントファミリーの内容が入る -->
                  </div>
                </div>
                <div class="create-style__dropdown-group font-weight">
                  <div
                    class="create-style__dropdown-toggle font-weight"
                    style="width: 100%"
                    data-label-type="font-weight"
                  >
                    <span class="create-style__dropdown-label">Auto</span>
                    <div class="create-style__dropdown-icon-container">
                      <span class="create-style__svg-container">
                        <svg
                          class="create-style__dropdown-icon"
                          xmlns="http://www.w3.org/2000/svg"
                          width="8"
                          height="7"
                          viewBox="0 0 8 7"
                        >
                          <path
                            fill-opacity="1"
                            fill-rule="evenodd"
                            d="m3.646 5.354-3-3 .708-.708L4 4.293l2.646-2.647.708.708-3 3L4 5.707l-.354-.353z"
                          ></path>
                        </svg>
                      </span>
                    </div>
                  </div>
                  <div
                    class="create-style__font-menu hidden font-weight-list-container"
                    role="menu"
                  >
                    <!-- フォントファミリーに対応するフォントフェイトの内容が入る -->
                  </div>
                </div>
              </div>
            </div>
            <div class="create-style__content">
              <div class="create-style__styles" id="mainView">
                <h2 class="create-style__tab-title">Japanese</h2>
              </div>
              <div class="create-style__dropdown" data-lang="Japanese">
                <div class="create-style__dropdown-group font-family">
                  <button
                    class="create-style__dropdown-toggle font-family"
                    data-label-type="font-family"
                    data-lang="Japanese"
                  >
                    <span class="create-style__dropdown-label" data-lang='Japanese'>Noto Sans JP</span>
                  </button>
                  <div
                    class="create-style__font-menu hidden font-family-list-container"
                    role="menu"
                  >
                    <div class="font_picker--fontPickerSearchRow--PBwi7">
                      <span class="svg-container font_picker--searchIcon--ADEyj"
                        ><svg
                          class="svg"
                          xmlns="http://www.w3.org/2000/svg"
                          width="11"
                          height="11"
                          viewBox="0 0 11 11"
                        >
                          <path
                            fill-opacity="1"
                            fill-rule="evenodd"
                            stroke="none"
                            d="M6.453 7.16C5.776 7.687 4.924 8 4 8 1.79 8 0 6.21 0 4c0-2.21 1.79-4 4-4 2.21 0 4 1.79 4 4 0 .924-.314 1.776-.84 2.453l3.194 3.193-.708.707L6.453 7.16zM7 4c0 1.657-1.343 3-3 3-1.657 0-3-1.343-3-3 0-1.657 1.343-3 3-3 1.657 0 3 1.343 3 3z"
                          ></path></svg
                      ></span>
                      <div class="font_picker--fontPickerSearchBar--XigbT">
                        <input
                          placeholder="Search fonts"
                          spellcheck="false"
                          class="font-search font_picker--fontPickerSearchBarInput--qOPld lazy_input--lazyInput--Ltb6r"
                          type="text"
                          data-testid="font-picker-search-input"
                          dir="auto"
                          value=""
                        />
                      </div>
                      <button class="options-button close" tabindex="0" aria-label="その他のオプション" data-tooltip-type="text" data-tooltip="その他のオプション">
                        <span class="apply-style__options-svg-container">
                          <svg class="apply-style__options-svg" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="nonzero" stroke="none" d="m6 5.293 4.789-4.79.707.708-4.79 4.79 4.79 4.789-.707.707-4.79-4.79-4.789 4.79-.707-.707L5.293 6 .502 1.211 1.21.504 6 5.294z" fill-opacity="1"></path>
                          </svg>
                        </span>
                      </button>
                    </div>
                    <div class="scroll_container"></div>
                    <!-- Figmaにインストールされたフォントファミリーの内容が入る -->
                  </div>
                </div>
                <div class="create-style__dropdown-group font-weight">
                  <div
                    class="create-style__dropdown-toggle font-weight"
                    style="width: 100%"
                    data-label-type="font-weight"
                  >
                    <span class="create-style__dropdown-label">Auto</span>
                    <div class="create-style__dropdown-icon-container">
                      <span class="create-style__svg-container">
                        <svg
                          class="create-style__dropdown-icon"
                          xmlns="http://www.w3.org/2000/svg"
                          width="8"
                          height="7"
                          viewBox="0 0 8 7"
                        >
                          <path
                            fill-opacity="1"
                            fill-rule="evenodd"
                            d="m3.646 5.354-3-3 .708-.708L4 4.293l2.646-2.647.708.708-3 3L4 5.707l-.354-.353z"
                          ></path>
                        </svg>
                      </span>
                    </div>
                  </div>
                  <div
                    class="create-style__font-menu hidden font-weight-list-container"
                    role="menu"
                  >
                    <!-- フォントファミリーに対応するフォントフェイトの内容が入る -->
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="create-style__form-action">
            <button tabindex="0" class="create-style__submit-button">
              Create style
            </button>
          </div>
        </div>
      </div>
      
      <!-- edit-style -->
      <div class="edit-style-container hidden">
        <!-- edit style -->
        <div class="tab-edit">
          <button
            class="options-button back"
            tabindex="0"
            aria-label="その他のオプション"
            data-tooltip-type="text"
            data-tooltip="その他のオプション"
          >
            <span class="apply-style__options-svg-container">
              <svg
                class="apply-style__options-svg"
                width="12"
                height="12"
                viewBox="0 0 12 12"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path 
                  fill-opacity="1"
                  fill-rule="evenodd"
                  stroke="none"
                  d="m6.344.343.706.708L2.083 6l4.967 4.95-.706.708L.667 6 6.344.343z"
                />
              </svg>
            </span>
          </button>
          <div class="tab-list__item">
            <span class="tab-list__edit-text">Edit style</span>
          </div>
          <div class="tab-list-active-indicator"></div>
        </div>
  
        <div>
          <!-- Edit style  -->
          <div class="edit-style">
            <!-- スタイル名 作成 -->
            <div class="create-style__input-groups">
              <div class="create-style__input-group">
                <label class="create-style__label" for="editStyleNameInput"
                  >Style name</label
                >
                <input
                  type="text"
                  id="editStyleNameInput"
                  spellcheck="false"
                  class="create-style__input"
                  name="styleName"
                  placeholder="New style"
                  autocomplete="off"
                  dir="auto"
                  value
                />
              </div>
            </div>
      
            <div class="create-style__tabs">
              <div class="create-style__tab-header">
                <h2 class="create-style__tab-title">Settings</h2>
              </div>
              <div class="create-style__content">
                <div class="create-style__styles" id="mainView">
                  <h2 class="create-style__tab-title">English</h2>
                </div>
                <div class="create-style__dropdown" data-lang="English">
                  <div class="create-style__dropdown-group font-family">
                    <button
                      class="create-style__dropdown-toggle font-family"
                      data-label-type="font-family"
                    >
                      <span class="create-style__dropdown-label">SF Pro</span>
                    </button>
                    <div
                      class="create-style__font-menu hidden font-family-list-container"
                      role="menu"
                    >
                      <div class="font_picker--fontPickerSearchRow--PBwi7">
                        <span class="svg-container font_picker--searchIcon--ADEyj"
                          ><svg
                            class="svg"
                            xmlns="http://www.w3.org/2000/svg"
                            width="11"
                            height="11"
                            viewBox="0 0 11 11"
                          >
                            <path
                              fill-opacity="1"
                              fill-rule="evenodd"
                              stroke="none"
                              d="M6.453 7.16C5.776 7.687 4.924 8 4 8 1.79 8 0 6.21 0 4c0-2.21 1.79-4 4-4 2.21 0 4 1.79 4 4 0 .924-.314 1.776-.84 2.453l3.194 3.193-.708.707L6.453 7.16zM7 4c0 1.657-1.343 3-3 3-1.657 0-3-1.343-3-3 0-1.657 1.343-3 3-3 1.657 0 3 1.343 3 3z"
                            ></path></svg
                        ></span>
                        <div class="font_picker--fontPickerSearchBar--XigbT">
                          <input
                            placeholder="Search fonts"
                            spellcheck="false"
                            class="font-search font_picker--fontPickerSearchBarInput--qOPld lazy_input--lazyInput--Ltb6r"
                            type="text"
                            data-testid="font-picker-search-input"
                            dir="auto"
                            value=""
                          />
                        </div>
                        <button class="options-button close" tabindex="0" aria-label="その他のオプション" data-tooltip-type="text" data-tooltip="その他のオプション">
                          <span class="apply-style__options-svg-container">
                            <svg class="apply-style__options-svg" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="nonzero" stroke="none" d="m6 5.293 4.789-4.79.707.708-4.79 4.79 4.79 4.789-.707.707-4.79-4.79-4.789 4.79-.707-.707L5.293 6 .502 1.211 1.21.504 6 5.294z" fill-opacity="1"></path>
                            </svg>
                          </span>
                        </button>
                      </div>
                      <div class="scroll_container"></div>
                      <!-- Figmaにインストールされたフォントファミリーの内容が入る -->
                    </div>
                  </div>
                  <div class="create-style__dropdown-group font-weight">
                    <div
                      class="create-style__dropdown-toggle font-weight"
                      style="width: 100%"
                      data-label-type="font-weight"
                    >
                      <span class="create-style__dropdown-label">Auto</span>
                      <div class="create-style__dropdown-icon-container">
                        <span class="create-style__svg-container">
                          <svg
                            class="create-style__dropdown-icon"
                            xmlns="http://www.w3.org/2000/svg"
                            width="8"
                            height="7"
                            viewBox="0 0 8 7"
                          >
                            <path
                              fill-opacity="1"
                              fill-rule="evenodd"
                              d="m3.646 5.354-3-3 .708-.708L4 4.293l2.646-2.647.708.708-3 3L4 5.707l-.354-.353z"
                            ></path>
                          </svg>
                        </span>
                      </div>
                    </div>
                    <div
                      class="create-style__font-menu hidden font-weight-list-container"
                      role="menu"
                    >
                      <!-- フォントファミリーに対応するフォントフェイトの内容が入る -->
                    </div>
                  </div>
                </div>
              </div>
              <div class="create-style__content">
                <div class="create-style__styles" id="mainView">
                  <h2 class="create-style__tab-title">Japanese</h2>
                </div>
                <div class="create-style__dropdown" data-lang="Japanese">
                  <div class="create-style__dropdown-group font-family">
                    <button
                      class="create-style__dropdown-toggle font-family"
                      data-label-type="font-family"
                    >
                      <span class="create-style__dropdown-label">Noto Sans JP</span>
                    </button>
                    <div
                      class="create-style__font-menu hidden font-family-list-container"
                      role="menu"
                    >
                      <div class="font_picker--fontPickerSearchRow--PBwi7">
                        <span class="svg-container font_picker--searchIcon--ADEyj"
                          ><svg
                            class="svg"
                            xmlns="http://www.w3.org/2000/svg"
                            width="11"
                            height="11"
                            viewBox="0 0 11 11"
                          >
                            <path
                              fill-opacity="1"
                              fill-rule="evenodd"
                              stroke="none"
                              d="M6.453 7.16C5.776 7.687 4.924 8 4 8 1.79 8 0 6.21 0 4c0-2.21 1.79-4 4-4 2.21 0 4 1.79 4 4 0 .924-.314 1.776-.84 2.453l3.194 3.193-.708.707L6.453 7.16zM7 4c0 1.657-1.343 3-3 3-1.657 0-3-1.343-3-3 0-1.657 1.343-3 3-3 1.657 0 3 1.343 3 3z"
                            ></path></svg
                        ></span>
                        <div class="font_picker--fontPickerSearchBar--XigbT">
                          <input
                            placeholder="Search fonts"
                            spellcheck="false"
                            class="font-search font_picker--fontPickerSearchBarInput--qOPld lazy_input--lazyInput--Ltb6r"
                            type="text"
                            data-testid="font-picker-search-input"
                            dir="auto"
                            value=""
                          />
                        </div>
                        <button class="options-button close" tabindex="0" aria-label="その他のオプション" data-tooltip-type="text" data-tooltip="その他のオプション">
                          <span class="apply-style__options-svg-container">
                            <svg class="apply-style__options-svg" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="nonzero" stroke="none" d="m6 5.293 4.789-4.79.707.708-4.79 4.79 4.79 4.789-.707.707-4.79-4.79-4.789 4.79-.707-.707L5.293 6 .502 1.211 1.21.504 6 5.294z" fill-opacity="1"></path>
                            </svg>
                          </span>
                        </button>
                      </div>
                      <div class="scroll_container"></div>
                      <!-- Figmaにインストールされたフォントファミリーの内容が入る -->
                    </div>
                  </div>
                  <div class="create-style__dropdown-group font-weight">
                    <div
                      class="create-style__dropdown-toggle font-weight"
                      style="width: 100%"
                      data-label-type="font-weight"
                    >
                      <span class="create-style__dropdown-label">Auto</span>
                      <div class="create-style__dropdown-icon-container">
                        <span class="create-style__svg-container">
                          <svg
                            class="create-style__dropdown-icon"
                            xmlns="http://www.w3.org/2000/svg"
                            width="8"
                            height="7"
                            viewBox="0 0 8 7"
                          >
                            <path
                              fill-opacity="1"
                              fill-rule="evenodd"
                              d="m3.646 5.354-3-3 .708-.708L4 4.293l2.646-2.647.708.708-3 3L4 5.707l-.354-.353z"
                            ></path>
                          </svg>
                        </span>
                      </div>
                    </div>
                    <div
                      class="create-style__font-menu hidden font-weight-list-container"
                      role="menu"
                    >
                      <!-- フォントファミリーに対応するフォントフェイトの内容が入る -->
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
  
        <div class="update__form-action">
          <button tabindex="0" class="update-button">
            Update style
          </button>
        </div>
      </div>
    </div>
    <!-- サンプル -->
    <div class="sample-text-container" id="sampleView">
      <!-- プレビュー -->
      <div class="sample-style__tabs">
        <div class="sample-style__tab-header">
          <h2 class="create-style__tab-title">Sample preview</h2>
          <button
            class="options-button sample"
            tabindex="0"
            aria-label="その他のオプション"
            data-tooltip-type="text"
            data-tooltip="その他のオプション"
          >
            <span class="apply-style__options-svg-container">
              <svg
                class="apply-style__options-svg"
                width="14"
                height="12"
                viewBox="0 0 14 12
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-opacity="1"
                  fill-rule="evenodd"
                  stroke="none"
                  d="m5 1.381-4 2.31v4.618l4 2.31 4-2.31V3.691L5 1.38zm5 1.732L5 .227 0 3.113v5.774l5 2.887 5-2.887V3.113zm3 5.196-5 2.887 1 .578 5-2.887V3.113L9 .227 8 .804l5 2.887v4.618zM6 6c0 .552-.448 1-1 1-.552 0-1-.448-1-1 0-.552.448-1 1-1 .552 0 1 .448 1 1z"
                ></path>
              </svg>
            </span>
          </button>
          <div class="popup">
            <div class="popup-arrow-container">
              <div class="popup-content">Sample style</div>
              <div class="popup-arrow">
                <svg width="13" height="7" viewBox="0 0 13 7" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M6.5 0L13 6.5H0L6.5 0Z" fill="#222222"></path>
                </svg>
              </div>
            </div>
          </div>
          <div class="sample-language-menu hidden" role="menu">
            <div class="font-menu__item" role="menuitem">
              <div class="font-menu__text sample">English</div>
              <svg class="font-menu__icon hidden" data-lang="English" viewBox="0 0 16 16" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M13.2067 5.20718L7.70669 10.7072L6.99959 11.4143L6.29248 10.7072L3.29248 7.70718L4.70669 6.29297L6.99959 8.58586L11.7925 3.79297L13.2067 5.20718Z" fill="white"></path>
              </svg>
            </div>
            <div class="font-menu__item" role="menuitem">
              <div class="font-menu__text sample">Japanese</div>
              <svg class="font-menu__icon hidden" data-lang="Japanese" viewBox="0 0 16 16" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M13.2067 5.20718L7.70669 10.7072L6.99959 11.4143L6.29248 10.7072L3.29248 7.70718L4.70669 6.29297L6.99959 8.58586L11.7925 3.79297L13.2067 5.20718Z" fill="white"></path>
              </svg>
            </div>
            <div class="popup-arrow">
              <svg width="13" height="7" viewBox="0 0 13 7" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M6.5 0L13 6.5H0L6.5 0Z" fill="#222222"></path>
              </svg>
            </div>
          </div>
        </div>
        <div class="sample-style__container">
          <div class="sample-style__message">
            <p class="sample-style__text">Preview Sample Text</p>
          </div>
          <div class="scroll_container" role="none">
            <div
              class="scroll_container--scrollBar"
              role="none"
              style="transform: translate3d(0px, 0px, 0px); height: 186.397px"
            ></div>
          </div>
        </div>
        <!-- Scale Controller -->
        <!-- <div class="component-rows">
          <div class="component-row">
            <div class="component-row__label">Scale</div>
            <div class="component-row__slider">
              <div class="slider" tabindex="0" data-input="scaleInput">
                <div class="slider__clip-container">
                  <div class="slider__track slider__track--light"></div>
                  <div class="slider__tick slider__tick--light" style="margin-left: 50%;"></div>
                  <div class="slider__thumb slider__thumb--inactive" style="margin-left: 50%;"></div>
                </div>
              </div>
            </div>
            <div>
              <input
                type="text"
                id="scaleInput"
                spellcheck="false"
                class="sample-style__input scale"
                name="styleName"
                placeholder="New style"
                autocomplete="off"
                dir="auto"
                value="1"
                min="0" 
                max="2"
              />
            </div>
          </div>
          <div class="component-row">
            <div class="component-row__label">X</div>
            <div class="component-row__slider">
              <div class="slider" tabindex="0" data-input="xInput">
                <div class="slider__clip-container">
                  <div class="slider__track slider__track--light"></div>
                  <div class="slider__tick slider__tick--light" style="margin-left: 50%;"></div>
                  <div class="slider__thumb slider__thumb--inactive" style="margin-left: 50%;"></div>
                </div>
              </div>
            </div>
            <div>
              <input
                type="text"
                id="xInput"
                spellcheck="false"
                class="sample-style__input scale"
                name="styleName"
                placeholder="New style"
                autocomplete="off"
                dir="auto"
                value="0"
                min="-100"
                max="100"
              />
            </div>
          </div>
          <div class="component-row">
            <div class="component-row__label">Y</div>
            <div class="component-row__slider">
              <div class="slider" tabindex="0" data-input="yInput">
                <div class="slider__clip-container">
                  <div class="slider__track slider__track--light"></div>
                  <div class="slider__tick slider__tick--light" style="margin-left: 50%;"></div>
                  <div class="slider__thumb slider__thumb--inactive" style="margin-left: 50%;"></div>
                </div>
              </div>
            </div>
            <div>
              <input
                type="text"
                id="yInput"
                spellcheck="false"
                class="sample-style__input scale"
                name="styleName"
                placeholder="New style"
                autocomplete="off"
                dir="auto"
                value="0"
                min="-100"
                max="100"
              />
            </div>
          </div>
        </div> -->
        <div class="create-style__input-groups">
          <div class="create-style__input-group">
            <label class="create-style__label" for="sampleTextContent"
              >Sample Content</label
            >
            <textarea
              type="text"
              id="sampleTextContent"
              spellcheck="false"
              class="sample-style__input"
              name="styleName"
              placeholder="Preview Sample Text"
              autocomplete="off"
              dir="auto"
              value=""
            ></textarea>
          </div>
        </div>
      </div>
    </div>
  </div>
  
</body>

<script>
  // 要素を取得します。
  const overlay = document.getElementById("overlay");
  const sampleView = document.getElementById("sampleView");
  const tabs = document.querySelectorAll(".tab-list__item");
  const tabContentsApplyStyle = document.querySelectorAll(".apply-style");
  const tabContentsCreateStyle = document.querySelectorAll(".create-style");
  const indicator = document.querySelector(".tab-list-active-indicator");
  const loader = document.querySelectorAll(".loading-indicator");
  const applyCreateStyleButton = document.querySelector(".options-button.create");
  const searchMenuCloseStyleButtons = document.querySelectorAll(".options-button.close");
  const backStyleButtons = document.querySelector(".options-button.back");
  const applyStylesContainer = document.querySelector(".apply-styles-container");
  const editStyleContainer = document.querySelector(".edit-style-container");
  const sampleTextContainer = document.querySelector(".sample-style__message");
  const sampleText = document.querySelector(".sample-style__text");
  const scrollSampleBar = document.querySelector(".scroll_container--scrollBar");
  const container = document.querySelector(".sample-style__container");
  const sampleStyleButton = document.querySelector(
    ".options-button.sample"
  );
  const sampleLaguageMenu = document.querySelector(
    ".sample-language-menu"
  );
  const sampleStyleLaguages = sampleLaguageMenu.querySelectorAll('.font-menu__item');

  let applyStyleItems;
  let applyStyleEditButtons;
  let applyStyleDeleteButtons;
  let layerName = null; // グローバルスコープに layerName 変数を追加
  
  // CreateStyleボタン押下時の処理
  const createStyleButton = document.querySelector(
    ".create-style__submit-button"
  );
  
  let currentStyleKey;
  let currentEditStyleNameInput;

  const updateButton = document.querySelector(
    ".update-button"
  );
  const applyStyleListContainer = document.querySelector(".apply-style__list__container");
  const applyStyleList = applyStyleListContainer.querySelector(".apply-style__list");
  const scrollContainer = applyStyleListContainer.querySelector(".scroll_container--track--HEzfy");

  const scrollBar = applyStyleListContainer.querySelector(".scroll_container--scrollBar--YLWIi");

  document.addEventListener("DOMContentLoaded", (event) => {
    updateFontStyleAndIcon('English');
    setupSliders();
    const scrollContainer = applyStyleList;
    const scrollBar = document.querySelector(
      ".scroll_container--scrollBar--YLWIi"
      );

    let isDragging = false;
  
    // スクロールバーの高さを計算する関数
    const setScrollBarHeight = () => {
      const scrollBarHeight = 42; // 高さを42pxに固定
      scrollBar.style.height = scrollBarHeight + "px";
    };
  
    // スクロールバーとスクロールコンテナの関連付け
    const updateScrollBarPosition = () => {
      const scrollFraction =
        scrollContainer.scrollTop /
        (scrollContainer.scrollHeight - scrollContainer.clientHeight);
      const topPosition =
        scrollFraction *
        (scrollContainer.clientHeight - scrollBar.offsetHeight);
      scrollBar.style.transform = `translate3d(0px, ${topPosition}px, 0px)`;
    };
  
    // イベントリスナー: マウスホイールでのスクロール操作
    scrollContainer.addEventListener("wheel", (e) => {
      e.preventDefault();
      const deltaY = e.deltaY * 0.5;
      scrollContent(deltaY);
    });
  
    // スクロールイベントにより、カスタムスクロールバーを更新
    scrollContainer.addEventListener("scroll", () => {
      updateScrollBarPosition();
    });
  
    // スクロール関数
    const scrollContent = (deltaY) => {
      scrollContainer.scrollTop += deltaY;
    };
  
    // ドラッグイベント用のヘルパー関数
    const startDrag = (e) => {
      isDragging = true;
      scrollBar.classList.add("dragging");
      document.body.classList.add("scrollbar-dragging");
    };
  
    const endDrag = (e) => {
      isDragging = false;
      scrollBar.classList.remove("dragging");
      document.body.classList.remove("scrollbar-dragging");
    };
  
    const doDrag = (e) => {
      if (isDragging) {
        const deltaY =
          e.movementY *
          (scrollContainer.scrollHeight / scrollContainer.clientHeight);
        scrollContent(deltaY);
      }
    };
  
    // ドラッグイベントリスナー
    scrollBar.addEventListener("mousedown", startDrag);
    document.addEventListener("mousemove", doDrag);
    document.addEventListener("mouseup", endDrag);
  
    // スクロールバーの高さの初期設定
    setScrollBarHeight();
    updateScrollBarPosition();
  });
  
  // スクロールバーの表示を制御するコード
  applyStyleListContainer.addEventListener("mouseover", function () {
    const applyStyleItem = applyStyleListContainer.querySelectorAll(".apply-style__item");
    if (applyStyleItem.length > 5) {
      // スクロールバーが必要な場合にのみ表示する
      scrollBar.style.display = "block";
    } else {
      // スクロールバーが不要な場合に非表示にする
      scrollBar.style.display = "none";
    }
  });

  // scrollContainerに対するmouseoverイベント用のコード
  scrollContainer.addEventListener("mouseover", function () {
    const computedStyle = window.getComputedStyle(scrollBar);
    if (computedStyle.display === "block") {
      scrollContainer.style.backgroundColor = "var(--figma-color-bg-hover)";
      scrollContainer.style.borderLeft = "1px solid var(--figma-color-border, #efefef)";
    }
  });
  
  // scrollContainerに対するmouseleaveイベント用のコード
  scrollContainer.addEventListener("mouseleave", function () {
    const computedStyle = window.getComputedStyle(scrollBar);
    if (computedStyle.display === "block") {
      scrollContainer.style.backgroundColor = ""; // backgroundColorをクリアする
      scrollContainer.style.borderLeft = ""; // borderLeftをクリアする
    }
  });

  // マウスがapplyStyleListContainerから離れたときにスクロールバーを非表示にする
  applyStyleListContainer.addEventListener("mouseleave", function () {
    scrollBar.style.display = "none";
  });
  let applyStyleNumber;
  // スクロールバーの表示と動作を制御するJavaScriptコード
  
  // 選択された要素とstyleの状態を表示
  let selectedName = null;
  let selectedEnv = null;
  let hasSelection = false;
  let isEnvSelected = false;
  
  // 利用可能な全フォント情報を格納する変数
  let availableFonts = []; // Figma APIから取得するデータ
  
  // 利用可能なフォントをロードするためにメインスクリプトに要求する
  parent.postMessage({ pluginMessage: { type: "load-fonts-request" } }, "*");
  
  // タブ切り替え設定
  tabs.forEach((tab, index) => {
    tab.addEventListener("click", () => {
      activateTab(tab);
      // タブの内容を切り替える
      toggleTabContents(index);
      toggleTabContentAndResize(index);
    });
  });
  activateTab(tabs[0]);
  toggleTabContents(0);
  toggleTabContentAndResize(0);
  
  // タブコンテンツの表示切り替えを行う関数
  function toggleTabContents(index) {
    // Apply Stylesタブが選択された場合（index 0）
    if (index === 0) {
      tabContentsApplyStyle.forEach((content) =>
        content.classList.remove("hidden")
      );
      tabContentsCreateStyle.forEach((content) =>
        content.classList.add("hidden")
      );
      sampleView.style.display = "none";
    }
    // Create Styleタブが選択された場合（index 1）
    else if (index === 1) {
      tabContentsApplyStyle.forEach((content) =>
        content.classList.add("hidden")
      );
      tabContentsCreateStyle.forEach((content) =>
        content.classList.remove("hidden")
      );
      sampleView.style.display = "flex";
    }
  }
  // タブが選択された際の関数を定義します。
  function activateTab(tab) {
    // すべてのタブからアクティブクラスを取り除きます。
    tabs.forEach((t) => {
      t.classList.remove("tab-list__item--active");
    });
  
    // 選択されたタブにアクティブクラスを追加します。
    tab.classList.add("tab-list__item--active");
  
    // インジケーターを活性状態にして、選択されたタブの位置に合わせます。
    indicator.style.display = "block";
    indicator.style.width = "67px";
    indicator.style.left = `${tab.offsetLeft}px`;
  }
  
  // UI側のスクリプト内で、タブの切り替えイベントを扱う
  function toggleTabContentAndResize(index) {
    // 新しい高さを計算する処理...
    let newHeight;
    let newWidth;
    // Apply Stylesタブが選択された場合（index 0）
    if (index === 0) {
      newHeight = 450;
      newWidth = 324;
    }
    // Create Styleタブが選択された場合（index 1）
    else if (index === 1) {
      newHeight = 373;
      newWidth = 700;
    }
    // Create Styleタブが選択された場合（index 1）
    else if (index === 2) {
      newHeight = 375;
      newWidth = 324;
    }
  
    // メインスクリプトに新しい高さを通知
    parent.postMessage(
      {
        pluginMessage: {
          type: "resize-ui",
          width: newWidth,
          height: newHeight,
        },
      },
      "*"
    );
  }
  
  // ローディング設定
  const circumference = 2 * Math.PI * 52;
  
  // 最初に円をリングとして表示するために、
  // stroke-dasharrayとstroke-dashoffsetを円周の長さにセットします
  const circle = document.querySelector(".progress-ring__circle");
  circle.style.strokeDasharray = `${circumference} ${circumference}`;
  circle.style.strokeDashoffset = circumference;
  
  function setProgress(percent) {
    // パーセントに応じたオフセットを計算します
    const offset = circumference - (percent / 100) * circumference;
    // オフセットを設定することでリングを描画します
    circle.style.strokeDashoffset = offset;
  }
  
  // メッセージがプラグインから送信されたときにイベントを発火させる
  window.onmessage = (event) => {
    const message = event.data.pluginMessage;
  
    // 共通のエレメントを取得
    const textElement = document.querySelector(
      ".apply-style__message .apply-style__text"
    ); // textElementをここで定義
    const loadingIndicator = document.getElementById("loadingIndicator");
  
    switch (message.type) {
      // 選択した要素関連メッセージ
      case "selection-cleared":
        textElement.innerHTML =
          "Select the element whose <br> text you want to change";
        textElement.style.color = "var(--figma-color-text-disabled)";
        textElement.style.fontWeight = "400";
        hasSelection = false;
        updateButtonState();
        break;
      case "update-name":
        textElement.textContent = message.name;
        layerName = message.name; // updatedName変数にmessage.nameを代入
        textElement.style.color = "var(--figma-color-text)";
        textElement.style.fontWeight = "600";
        hasSelection = true;
        updateButtonState();
        break;
      case "update-progress":
        loadingIndicator.classList.remove("hidden");
        // 進捗状況のパーセンテージを受け取る
        const progressPercent = event.data.pluginMessage.progress;
        // 進捗インジケータを更新する
        setProgress(progressPercent);
        break;
      case "hide-loading":
        loadingIndicator.classList.add("hidden");
        break;
      case "load-fonts":
        // メッセージからフォント情報を取得する
        availableFonts = message.fonts;
        let fontFamilyListContainers;
        let fontWeightListContainers;
  
        fontFamilyListContainers = document.querySelectorAll(
          ".font-family-list-container"
        );
        fontWeightListContainers = document.querySelectorAll(
          ".font-weight-list-container"
        );
        // listContainer領域外のクリックを検知するための関数
  
        searchMenuCloseStyleButtons.forEach((btn) => {
          btn.addEventListener("click", () => {
            fontFamilyListContainers.forEach((listContainer) => {
              listContainer.classList.add("hidden");
            });
          })
        });
        function handleDocumentClick(event) {
          fontFamilyListContainers.forEach((listContainer) => {
            // クリックがlistContainerまたはtoggle内のものでない場合、hiddenクラスを追加
            if (
              listContainer.contains(event.target) ||
              listContainer.previousElementSibling.contains(event.target)
            ) {
              // クリックしたのがlistContainer内、もしくはlistContainerに隣接する要素（toggleボタン）の場合は何もしない
            } else {
              listContainer.classList.add("hidden");
            }
          });
          fontWeightListContainers.forEach((listContainer) => {
            // クリックがlistContainerまたはtoggle内のものでない場合、hiddenクラスを追加
            if (
              listContainer.contains(event.target) ||
              listContainer.previousElementSibling.contains(event.target)
            ) {
              // クリックしたのがlistContainer内、もしくはlistContainerに隣接する要素（toggleボタン）の場合は何もしない
            } else {
              listContainer.classList.add("hidden");
            }
          });
        }
  
        document.addEventListener("click", handleDocumentClick);
  
        const createStyleContents = document.querySelectorAll(
          ".create-style__content"
        );

        // 対象の要素を取得する
        const labelEnglish = document.querySelector(".create-style__dropdown-label[data-lang='English']");
        const labelJapanese = document.querySelector(".create-style__dropdown-label[data-lang='Japanese']");
        
        // MutationObserverのコールバック関数を定義
        const observerCallback = (mutationsList, observer) => {
          for (let mutation of mutationsList) {
            if ((mutation.type === 'childList' || mutation.type === 'characterData') && sampleText) {
              // sampleTextの現在の言語設定を確認する
              const sampleTextLang = sampleText.getAttribute('data-lang');
              // 変更が起きた要素の言語設定を取得
              const targetLang = mutation.target.getAttribute('data-lang');
              // sampleTextと変更が起きた要素が同じ言語であるか確認
              if (sampleTextLang === targetLang) {
                // sampleTextのフォントファミリーを更新
                sampleText.style.fontFamily = mutation.target.textContent;
                console.log('sampleTextのフォントファミリーを更新');
              }
            }
          }
        };

        // MutationObserverインスタンスの作成と監視の開始
        const observer = new MutationObserver(observerCallback);
        const config = { childList: true, characterData: true, subtree: true };

        // 監視対象の要素が存在するか確認し、存在する場合は監視を開始する
        if (labelEnglish) {
          observer.observe(labelEnglish, config);
        }
        if (labelJapanese) {
          observer.observe(labelJapanese, config);
        }


        createStyleContents.forEach((content) => {
          const fontFamilyListContainer = content.querySelector(
            ".font-family-list-container"
          );
          const searchInputContainer = content.querySelector(".font-search");
          const scrollContainer = content.querySelector(".scroll_container");
          setupSearchFunctionality(searchInputContainer, scrollContainer);
          const fontWeightListContainer = content.querySelector(
            ".font-weight-list-container"
          );
          const fontWeightSelectBtn = content.querySelector(
            ".create-style__dropdown-toggle.font-weight"
          );
          const dropDownToggle = content.querySelector(
            ".create-style__dropdown-toggle.font-family"
          );
          let fontWeightLabel = content.querySelector(
            ".create-style__dropdown-toggle.font-weight .create-style__dropdown-label"
          );
          let allFontFamilyItems = [];
  
          // 既存のリスト内容を一度クリアする
          scrollContainer.innerHTML = "";
  
          // 重複せずにフォントファミリー名を記録するためのSetを作成
          const addedFontFamilies = new Set();
          
          availableFonts.sort((a, b) => {
            const nameA = a.fontName.family;
            const nameB = b.fontName.family;
            // "?????" をリストの最後に配置
            if (nameA === '?????' && nameB !== '?????') return 1;
            if (nameA !== '?????' && nameB === '?????') return -1;
            // "."で始まるフォント名称はリストの後ろ（ただし、"?????"の前）に移動
            if (nameA.startsWith('.') && !nameB.startsWith('.') && nameB !== '?????') return 1;
            if (!nameA.startsWith('.') && nameB.startsWith('.') && nameA !== '?????') return -1;
            // それ以外の場合はアルファベット順にソート
            // 上記でなければ、通常の文字列比較でソート
            return nameA.localeCompare(nameB);
          });
          // 各コンテナに同じフォントリストを追加する
          availableFonts.forEach((font) => {
            // フォントファミリー名がSetにまだ追加されていない場合のみ項目を作成する
            if (!addedFontFamilies.has(font.fontName.family)) {
              addedFontFamilies.add(font.fontName.family);
  
              // 新しいフォントファミリーのメニュー項目を作成
              const item = document.createElement("div");
              item.className = "font-menu__item font-item";
              item.setAttribute("role", "menuitem");
  
              // フォントファミリー名を表示するためのテキスト部分を作成
              const text = document.createElement("div");
              text.className = "font-menu__text";
              text.textContent = font.fontName.family;
              text.style.fontFamily = `"${font.fontName.family}"`;
              item.appendChild(text);

              // チェックアイコンを追加
              const checkIcon = createCheckIconFontFamily();
              item.appendChild(checkIcon);
  
              // リストにメニュー項目を追加
              scrollContainer.appendChild(item);

              // font-family メニュー配列に追加
              allFontFamilyItems.push(item);
            }
          });
          

          dropDownToggle.addEventListener("click", () => {
            fontFamilyListContainer.classList.add("hidden");
            // ボタンに関連づけられたリストコンテナを取得する
            if (fontFamilyListContainer) {
              fontFamilyListContainer.classList.toggle("hidden"); // クリックごとにリストの表示・非表示を切り替える
              const currentFontFamily = content.querySelector(
                ".create-style__dropdown-toggle.font-family .create-style__dropdown-label"
              ).textContent;
              refreshCheckIcons(currentFontFamily, allFontFamilyItems);
              event.stopPropagation(); // ドキュメントレベルのイベントリスナーが反応しないようにする
            }
          });
          fontWeightSelectBtn.addEventListener("click", () => {
            if (fontWeightListContainer) {
              fontWeightListContainer.classList.remove("hidden");
              overlay.classList.remove("hidden");
              document.body.classList.add("menu-open");
              // 現在のフォントファミリーラベルからフォント名を取得
              const currentFontFamily = content.querySelector(
                ".create-style__dropdown-toggle.font-family .create-style__dropdown-label"
              ).textContent;
              // 表示されるべきフォントウェイト一覧を表示する
              makeFontWeightLists(
                currentFontFamily,
                fontWeightListContainer,
                fontWeightLabel
              );
              allFontWeightItems = makeFontWeightLists(
                currentFontFamily,
                fontWeightListContainer,
                fontWeightLabel
              );
              refreshCheckIcons(fontWeightLabel.textContent, allFontWeightItems);
            } else {
              fontWeightListContainer.classList.add("hidden");
              overlay.classList.add("hidden");
              document.body.classList.remove("menu-open");
            }
          });
          scrollContainer.childNodes.forEach((item) => {
            item.addEventListener("click", (event) => {
              const fontName = item.textContent;
              // 親の '.create-style__dropdown' を取得して、関連するラベルを更新する
              const dropDown = fontFamilyListContainer.closest(
                ".create-style__dropdown"
                );
              const label = dropDown.querySelector(
                ".create-style__dropdown-label"
                );
              const fontWeight = dropDown.querySelector(
                ".font-weight"
                );
              const fontWeightLabel = fontWeight.querySelector(
                ".create-style__dropdown-label"
                );
              if (label) {
                label.textContent = fontName;
                fontWeightLabel.textContent = "Auto";
              }
  
              fontFamilyListContainer.classList.add("hidden"); // 項目を選択した後、リストを閉じる
              makeFontWeightLists(
                fontName,
                fontWeightListContainer,
                fontWeightLabel
              );
  
              // リストアイテムのイベントが「ボタン」までバブリングしてボタンのクリックイベントが発火するのを防ぐ
              event.stopPropagation();
            });
          });
        });
        break;
      case "add-style-to-list":
        applyStyleItems = document.querySelectorAll(".apply-style__item");
  
        // 新しいリストアイテムを作成
        const styleName = message.styleName;
        const env = message.env;
  
        let isEnvExists = false;
        applyStyleItems.forEach((item) => {
          if (item.getAttribute("data-env") === env) {
            isEnvExists = true;
          }
        });
  
        // 既に存在する場合は、新しいリストアイテムの追加をスキップする
        if (isEnvExists) {
          break;
        }
  
        const newItem = document.createElement("li");
        newItem.classList.add("apply-style__item");
        newItem.setAttribute("data-env", env);
  
        // リストアイテムに追加するHTMLコンテンツを設定
        newItem.innerHTML = `
          <div class="apply-style__item-content">
            <h3 class="apply-style__item-title">${styleName}</h3>
          </div>
          <button
            class="options-button edit"
            tabindex="0"
            aria-label="その他のオプション"
            data-tooltip-type="text"
            data-tooltip="その他のオプション"
          >
            <span class="apply-style__options-svg-container">
              <svg
                class="apply-style__options-svg"
                width="32"
                height="32"
                viewBox="0 0 32 32"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M12 16.05V9H13V16.05C14.1411 16.2816 15 17.2905 15 18.5C15 19.7095 14.1411 20.7184 13 20.95V23H12V20.95C10.8589 20.7184 10 19.7095 10 18.5C10 17.2905 10.8589 16.2816 12 16.05ZM14 18.5C14 19.3284 13.3284 20 12.5 20C11.6716 20 11 19.3284 11 18.5C11 17.6716 11.6716 17 12.5 17C13.3284 17 14 17.6716 14 18.5ZM19 23H20V15.95C21.1411 15.7184 22 14.7095 22 13.5C22 12.2905 21.1411 11.2816 20 11.05V9H19V11.05C17.8589 11.2816 17 12.2905 17 13.5C17 14.7095 17.8589 15.7184 19 15.95V23ZM21 13.5C21 12.6716 20.3284 12 19.5 12C18.6716 12 18 12.6716 18 13.5C18 14.3284 18.6716 15 19.5 15C20.3284 15 21 14.3284 21 13.5Z"
                />
              </svg>
            </span>
          </button>
          <div class="popup edit">
            <div class="popup-arrow-container">
              <div class="popup-content">Edit style</div>
              <div class="popup-arrow">
                <svg
                  width="13"
                  height="7"
                  viewBox="0 0 13 7"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path d="M6.5 0L13 6.5H0L6.5 0Z" fill="#222222" />
                </svg>
              </div>
            </div>
          </div>
          <button
            class="options-button delete"
            tabindex="0"
            aria-label="その他のオプション"
            data-tooltip-type="text"
            data-tooltip="その他のオプション"
          >
            <span class="apply-style__options-svg-container">
              <svg
                class="apply-style__options-svg"
                width="32"
                height="32"
                viewBox="0 0 32 32"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M15 9.5C14.4477 9.5 14 9.94772 14 10.5H18C18 9.94772 17.5523 9.5 17 9.5H15ZM19 10.5C19 9.39543 18.1046 8.5 17 8.5H15C13.8954 8.5 13 9.39543 13 10.5H11.5H10V11.5H11V21.5C11 22.6046 11.8954 23.5 13 23.5H19C20.1046 23.5 21 22.6046 21 21.5V11.5H22V10.5H20.5H19ZM20 11.5H18.5H13.5H12V21.5C12 22.0523 12.4477 22.5 13 22.5H19C19.5523 22.5 20 22.0523 20 21.5V11.5ZM14 18.5V14.5H15V18.5H14ZM17 18.5V14.5H18V18.5H17Z"
                />
              </svg>
            </span>
          </button>
  
          <div class="popup delete">
            <div class="popup-arrow-container">
              <div class="popup-content">Delete style</div>
              <div class="popup-arrow">
                <svg
                  width="13"
                  height="7"
                  viewBox="0 0 13 7"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path d="M6.5 0L13 6.5H0L6.5 0Z" fill="#222222" />
                </svg>
              </div>
            </div>
          </div>
          <!-- その他のオプションボタンとポップアップ、メニューなどを含むHTMLをここに追加 -->
        `;
  
        // apply-style__listの要素に新しいリストアイテムを追加
        applyStyleList.appendChild(newItem);

        // 新しいリストアイテムに関するイベントをここで追加しています
        newItem.addEventListener("click", function (e) {
          // クリックイベントのバブリングを止める
          e.stopPropagation();
  
          // 他のアイテムのアクティブ状態を解除
          removeAllActiveItems();
          removeAllActiveButtons();
  
          // クリックされたアイテムにアクティブクラスを切り替え
          newItem.classList.toggle("active");
          selectedName = newItem.querySelector(
            ".apply-style__item-title"
          ).textContent; // スタイル名を取得
          selectedEnv = newItem.getAttribute("data-env"); // 環境を取得
  
          // ボタンの状態を更新
          updateButtonState();
        });
        // 設定/編集ボタンに関するイベントリスナーをここで追加できます。
        const applyStyleEditButton = newItem.querySelector(
          ".options-button.edit"
        );
        const applyStyleDeleteButton = newItem.querySelector(
          ".options-button.delete"
        );
        applyStyleEditButton.addEventListener("click", function (e) {
          // イベントのバブリングを阻止
          e.stopPropagation();
  
          removeAllActiveButtons();
  
          // クリックされた要素がボタン自体ではなく子要素の場合、closestを使用してボタン要素を取得
          const buttonElement = e.target.closest(
            ".options-button"
          );
  
          // data-env 属性を持つ最も近い親要素を取得
          const parentItem = buttonElement.closest("[data-env]");
          // 親要素から data-env 属性の値を取得
          const dataEnvValue = parentItem ? parentItem.getAttribute('data-env') : null;
          // apply-style__item-title クラスを持つ要素を親要素から検索し、そのテキスト内容を取得
          const styleTitle = parentItem ? parentItem.querySelector('.apply-style__item-title').textContent : null;

          applyStylesContainer.classList.add("hidden");
          editStyleContainer.classList.remove("hidden");

          toggleTabContentAndResize(2);

          parent.postMessage(
            {
              pluginMessage: {
                type: "get-saved-style",
                key: dataEnvValue,
                styleName: styleTitle,
              },
            },
            "*"
          );
  
          // 他のアクティブな項目を非アクティブにする
          removeAllActiveItems();
        });
        applyStyleDeleteButton.addEventListener("click", function (e) {
          e.stopPropagation(); // イベントバブリングを防ぐ
          const envValue = newItem.getAttribute("data-env");
          let itemToDelete = document.querySelector(
            `.apply-style__item[data-env="${envValue}"]`
          ); // DOM 要素を取得
          if (itemToDelete) {
            itemToDelete.remove(); // DOM 要素を削除
          }
          parent.postMessage(
            {
              pluginMessage: {
                type: "delete-style",
                env: newItem.getAttribute("data-env"),
              },
            },
            "*"
          );
        });

        sampleStyleButton.addEventListener("click", function (e) {
          // イベントのバブリングを阻止
          removeAllActiveButtons();
          
          // クリックされた要素がボタン自体ではなく子要素の場合、closestを使用してボタン要素を取得
          const buttonElement = e.target.closest(".options-button");
          
          // ボタンのアクティブ状態をトグルする
          let isActive = buttonElement.classList.toggle("active");
          if (isActive) {
            e.stopPropagation();
            sampleLaguageMenu.classList.remove("hidden");
            overlay.classList.remove("hidden");
            document.body.classList.add("menu-open");
          } else {
            sampleLaguageMenu.classList.add("hidden");
            overlay.classList.add("hidden");
            document.body.classList.remove("menu-open");
          }

          // 他のアクティブな項目を非アクティブにする
          removeAllActiveItems();
        });
        sampleStyleLaguages.forEach((item) => {
          item.addEventListener("click", function (e) {
            sampleLaguageMenu.classList.add("hidden");
            overlay.classList.add("hidden");
            document.body.classList.remove("menu-open");
            let textStyle
            
            const menuItem = item.querySelector(".font-menu__text.sample");
            if (menuItem.textContent === "Japanese") {
              updateFontStyleAndIcon('Japanese');
            } else if (menuItem.textContent === "English") {
              updateFontStyleAndIcon('English');
            }
            const icon = item.querySelector(".font-menu__icon");
            icon.classList.remove("hidden");
          });
        });
        document.addEventListener("click", function (e) {
          sampleLaguageMenu.classList.add("hidden");
          overlay.classList.add("hidden");
          document.body.classList.remove("menu-open");
        });
        break;
      case "set-saved-style":
        // 設定されたスタイルを表示するためのコードをここに追加
        const editStyleNameInput = document.getElementById("editStyleNameInput");
        editStyleNameInput.value = message.styleNames;

        const editStyleContainerEnglish = editStyleContainer.querySelector('[data-lang="English"]')
        const editStyleContainerEnglishFontFamily = editStyleContainerEnglish.querySelector('.font-family');
        editStyleContainerEnglishFontFamily.querySelector('.create-style__dropdown-label').textContent = message.englishFontFamily
        const editStyleContainerEnglishFontWeight = editStyleContainerEnglish.querySelector('.font-weight');
        editStyleContainerEnglishFontWeight.querySelector('.create-style__dropdown-label').textContent = message.englishFontWeight

        const editStyleContainerJapanese = editStyleContainer.querySelector('[data-lang="Japanese"]')
        const editStyleContainerJapaneseFontFamily = editStyleContainerJapanese.querySelector('.font-family');
        editStyleContainerJapaneseFontFamily.querySelector('.create-style__dropdown-label').textContent = message.japaneseFontFamily
        const editStyleContainerJapaneseFontWeight = editStyleContainerJapanese.querySelector('.font-weight');
        editStyleContainerJapaneseFontWeight.querySelector('.create-style__dropdown-label').textContent = message.japaneseFontWeight
        currentStyleKey = message.styleKey;
        currentEditStyleNameInput = editStyleNameInput;
        
        break;
      case "style-updated":
        const Items = applyStyleList.querySelectorAll(".apply-style__item")
        Items.forEach((item) => {
          if (item.getAttribute("data-env") === message.key) {
            const titleElement = item.querySelector(".apply-style__item-title");
            if (titleElement.textContent !== message.styleName) {
              titleElement.textContent = message.styleName;
            }
          }
        });
        break;
    }
  };

  function updateButtonClicked() {
    // スタイル名のインプット要素から値を取得
    const styleKey = currentStyleKey; // クロージャにより保存された現在のstyleKeyを取得
    const styleName = currentEditStyleNameInput.value.trim();
    // styleName が空でないことを確認します
    if (!styleName) {
      alert("Please enter a style name.");
      return;
    }

    // フォントスタイル情報をそれぞれのドロップダウンから取得
    const japaneseFontFamily = editStyleContainer
      .querySelector('[data-lang="Japanese"] [data-label-type="font-family"]')
      .textContent.trim();
    const japaneseFontWeight = editStyleContainer
      .querySelector('[data-lang="Japanese"] [data-label-type="font-weight"]')
      .textContent.trim();
    const englishFontFamily = editStyleContainer
      .querySelector('[data-lang="English"] [data-label-type="font-family"]')
      .textContent.trim();
    const englishFontWeight = editStyleContainer
      .querySelector('[data-lang="English"] [data-label-type="font-weight"]')
      .textContent.trim();

    // 各言語のフォント設定を格納するオブジェクトを作成します
    const fontSettings = {
      Japanese: {
        fontFamily: japaneseFontFamily,
        fontWeight: japaneseFontWeight,
      },
      English: {
        fontFamily: englishFontFamily,
        fontWeight: englishFontWeight,
      },
    };

    // スタイル名とフォント設定をFigmaプラグインのメインコードに送信
    parent.postMessage(
      {
        pluginMessage: {
          type: "update-style",
          styleName: styleName,
          fontSettings: fontSettings,
          key: styleKey,
        },
      },
      "*"
    );

    applyStylesContainer.classList.remove("hidden");
    editStyleContainer.classList.add("hidden");
    toggleTabContentAndResize(0);
    updateButton.addEventListener("click", function () {
    });
  }

  // ページがロードされたときに一度だけイベントリスナーを登録します
  updateButton.addEventListener("click", updateButtonClicked);
  

  // edit-style-btnのイベントリスナーを追加
  backStyleButtons.addEventListener("click", function () {
    applyStylesContainer.classList.remove("hidden");
    editStyleContainer.classList.add("hidden");
    toggleTabContentAndResize(0);
  });
  document.addEventListener("DOMContentLoaded", function () {
    // スクロール内容の更新に応じてスクロールバーの位置を更新する関数
    const updateScrollBarPosition = () => {
      const scrollAmount = sampleTextContainer.scrollTop;
      const topPosition = (scrollAmount / sampleTextContainer.scrollHeight) * sampleTextContainer.clientHeight;
      scrollSampleBar.style.setProperty('--scroll-top', `${topPosition}px`);
    };

    // スクロールバーの高さと位置の更新関数
    const updateScrollBar = () => {
      const contentHeight = sampleText.scrollHeight;
      const containerHeight = sampleTextContainer.clientHeight;
      const isScrollable = contentHeight > containerHeight;
      const scrollRatio = containerHeight / contentHeight;
      const scrollBarHeight = scrollRatio * containerHeight;

      scrollSampleBar.style.display = isScrollable ? "block" : "none";
      scrollSampleBar.style.height = `${scrollBarHeight}px`;

      const handleMouseEnter = () => {
        if (isScrollable) {
          scrollSampleBar.style.display = "block";
        }
      };
      const handleMouseLeave = () => {
        scrollSampleBar.style.display = "none";
      };
      

      // テキストの長さに応じた条件処理
      if (sampleText.textContent.length > 119) {
        sampleTextContainer.style.placeContent = 'start';
        container.addEventListener("mouseenter", handleMouseEnter);
        container.addEventListener("mouseleave", handleMouseLeave);
      } else {
        sampleTextContainer.style.placeContent = 'center';
        container.removeEventListener("mouseenter", handleMouseEnter);
        container.removeEventListener("mouseleave", handleMouseLeave);
      }
    };

    // テキスト内容が変更されたときにupdateScrollBarを呼び出すためのMutationObserverの設定
    const observer = new MutationObserver(updateScrollBar);
    observer.observe(sampleText, { childList: true, characterData: true, subtree: true });

    // ロード時とスクロール時にスクロールバーを更新する
    updateScrollBar();
    sampleTextContainer.addEventListener("scroll", updateScrollBarPosition);
    new ResizeObserver(updateScrollBar).observe(sampleTextContainer);

    let textarea = document.getElementById("sampleTextContent");
    let defaultText = "Preview Sample Text";
  
    textarea.addEventListener("input", function () {
      if (sampleText !== null) {
        if (this.value) {
          sampleText.textContent = this.value;
          sampleText.style.color = "var(--figma-color-text)";
        } else {
          sampleText.textContent = defaultText;
          sampleText.style.color = "var(--figma-color-text-disabled)";
        }
      }
    });
  });
  // フォント/icon設定を更新する関数
  function updateFontStyleAndIcon(language) {
    const langSuffix = language === 'Japanese' ? 'Japanese' : 'English';
    const fontFamilySelector = `.create-style__dropdown-label[data-lang="${langSuffix}"]`;
    const fontFamily = document.querySelector(fontFamilySelector).textContent.trim();
    sampleText.style.fontFamily = fontFamily;

    // sampleTextにdata-lang属性を設定する
    sampleText.setAttribute('data-lang', langSuffix);

    // すべてのアイコンを非表示にする
    sampleLaguageMenu.querySelectorAll(".font-menu__icon").forEach((icon) => {
      icon.classList.add("hidden");
    });

    // 選択した言語のアイコンのみ表示する
    const selectedIconSelector = `.font-menu__icon[data-lang="${langSuffix}"]`;
    const selectedIcon = sampleLaguageMenu.querySelector(selectedIconSelector);
    if (selectedIcon) {
      selectedIcon.classList.remove("hidden");
    }
  }
  // 検索機能を設定する関数
  function setupSearchFunctionality(searchInputContainer, scrollContainer) {
    // 検索イベントリスナーを追加
    searchInputContainer.addEventListener("input", function () {
      let searchText = searchInputContainer.value.toLowerCase();
  
      if (searchInputContainer) {
        // 検索イベントリスナーを追加
        searchInputContainer.addEventListener("input", function () {
          let searchText = searchInputContainer.value.toLowerCase();
  
          // この時点でのfont-itemsを再取得する
          let fontItems = scrollContainer.querySelectorAll(".font-item");
  
          fontItems.forEach(function (item) {
            let fontName = item
              .querySelector(".font-menu__text")
              .textContent.toLowerCase();
            if (fontName.includes(searchText)) {
              item.style.display = "";
            } else {
              item.style.display = "none";
            }
          });
        });
      }
    });
  }

  let allFontWeightItems = [];

  // font-familyのメニューで使用するアイコン設定
  function createCheckIconFontFamily() {
    const namespace = "http://www.w3.org/2000/svg"; // SVGの名前空間
    const checkIcon = document.createElementNS(namespace, "svg");
    checkIcon.setAttribute("class", "font-menu__icon font-family hidden");
    checkIcon.setAttribute("viewBox", "0 0 16 16");
    checkIcon.setAttribute("fill", "none");

    const path = document.createElementNS(namespace, "path");
    path.setAttribute("fill-rule", "evenodd");
    path.setAttribute("clip-rule", "evenodd");
    path.setAttribute(
      "d",
      "M13.2067 5.20718L7.70669 10.7072L6.99959 11.4143L6.29248 10.7072L3.29248 7.70718L4.70669 6.29297L6.99959 8.58586L11.7925 3.79297L13.2067 5.20718Z"
    );
    path.setAttribute("fill", "var(--figma-color-icon)");

    checkIcon.appendChild(path);
    return checkIcon;
  }

  // フォントウェイトを表示する関数
  function makeFontWeightLists(
    fontFamilyName,
    fontWeightListContainer,
    fontWeightLabel
  ) {
    fontWeightListContainer.innerHTML = ""; // コンテナをクリア
    
    const fontWeights = availableFonts.filter(
      (font) => font.fontName.family === fontFamilyName
    );

    function createCheckIcon() {
      const namespace = "http://www.w3.org/2000/svg"; // SVGの名前空間
      const checkIcon = document.createElementNS(namespace, "svg");
      checkIcon.setAttribute("class", "font-menu__icon hidden");
      checkIcon.setAttribute("viewBox", "0 0 16 16");
      checkIcon.setAttribute("fill", "none");
  
      const path = document.createElementNS(namespace, "path");
      path.setAttribute("fill-rule", "evenodd");
      path.setAttribute("clip-rule", "evenodd");
      path.setAttribute(
        "d",
        "M13.2067 5.20718L7.70669 10.7072L6.99959 11.4143L6.29248 10.7072L3.29248 7.70718L4.70669 6.29297L6.99959 8.58586L11.7925 3.79297L13.2067 5.20718Z"
      );
      path.setAttribute("fill", "white");
  
      checkIcon.appendChild(path);
      return checkIcon;
    }
  
    let defaultFontWeight;
    // 'Regular' があるかどうか確認し、設定する
    //const regularFontWeight = fontWeights.find(
    //  (font) => font.fontName.style === "Regular"
    //);

    // 'Auto' オプションを作成して追加
    const autoItem = document.createElement("div");
    autoItem.className = "font-menu__item";
    autoItem.setAttribute("role", "menuitem");
    
    const autoText = document.createElement("div");
    autoText.className = "font-menu__text font-weight";
    autoText.textContent = "Auto";
    autoItem.appendChild(autoText);
    
    // チェックアイコンを作成して追加
    // createCheckIcon() 関数は、このコードの上部で定義してあると仮定します。
    const checkIconAuto = createCheckIcon();
    autoItem.appendChild(checkIconAuto);
    
    // デフォルトの選択肢として 'Auto' オプションを設定
    allFontWeightItems.push(autoItem); // オプションを配列に追加
    fontWeightListContainer.appendChild(autoItem);

    // フォントウェイトリストに区切り線を追加
    const dividerContainer = document.createElement("div");
    dividerContainer.className = "font-menu__divider";
    dividerContainer.setAttribute("role", "menudivider");
    const divider = document.createElement("div");
    divider.className = "font-menu__divider__item";
    dividerContainer.appendChild(divider);
    fontWeightListContainer.appendChild(dividerContainer);
    fontWeights.forEach((font) => {
    // 新しいフォントウェイトのメニュー項目を作成
    const item = document.createElement("div");
    item.className = "font-menu__item";
    item.setAttribute("role", "menuitem");

    // フォントウェイト名を表示するためのテキスト部分を作成
    const text = document.createElement("div");
    text.className = "font-menu__text font-weight";
    text.textContent = font.fontName.style;
    item.appendChild(text);

    // チェックアイコンを追加
    const checkIcon = createCheckIcon();
    item.appendChild(checkIcon);

    // リストにメニュー項目を追加
    fontWeightListContainer.appendChild(item);

    // 作成したメニュー項目を配列に追加
    allFontWeightItems.push(item);

    // デフォルトフォントウェイトを特定する
    if (!defaultFontWeight || font.fontName.style === "Auto") {
      defaultFontWeight = item;
    }
    });

    refreshCheckIcons(fontWeightLabel.textContent, allFontWeightItems);
  
    
    let useFontWeightLists = allFontWeightItems.map((item) => {
      return item.querySelector(".font-menu__text.font-weight");
    });

    let fontMenuItems = fontWeightListContainer.querySelectorAll(".font-menu__item");

    fontMenuItems.forEach((item) => {
      item.addEventListener("click", (event) => {
        fontWeightLabel.textContent = item.textContent; // ラベルを更新
        refreshCheckIcons(fontWeightLabel.textContent, allFontWeightItems);
        fontWeightListContainer.classList.add("hidden"); // フォントウェイトリストを閉じる
        
        // 他のすべてのアイテムのチェックアイコンにhiddenクラスを追加する
        let checkdIcon = item.querySelector(".font-menu__icon");
        allFontWeightItems.forEach((cItem) => {
          const icon = cItem.querySelector(".font-menu__icon");
          if (icon) icon.classList.add("hidden");
        });

        // 現在選択されたアイテムのチェックアイコンのhiddenクラスを削除する
        event.stopPropagation();
      });
      // デフォルトフォントウェイトを特定する
      if (!defaultFontWeight || item.textContent === "Auto") {
        defaultFontWeight = item;
      }
    });
    // デフォルトフォントウェイトをラベルとチェック状態に設定する
    //if (defaultFontWeight) {
    //  fontWeightLabel.textContent = regularFontWeight
    //    ? "Auto"
    //    : fontWeights[0].fontName.style;
    //  refreshCheckIcons(fontWeightLabel.textContent, allFontWeightItems);
    //}
    return allFontWeightItems;
  }
  function refreshCheckIcons(selectedWeightLabel, allFontWeightItems) {
    // すべてのcheckIconにhiddenクラスを追加
    allFontWeightItems.forEach((item) => {
      const icon = item.querySelector('.font-menu__icon');
      if (icon) icon.classList.add('hidden');
    });

    // `selectedWeightLabel`に一致するアイテムを探し、そのチェックアイコンを表示
    allFontWeightItems.forEach((item) => {
      const textElement = item.querySelector('.font-menu__text');
      if(textElement.textContent === selectedWeightLabel) {
        const iconToShow = item.querySelector('.font-menu__icon');
        iconToShow.classList.remove('hidden');
      }
    });
  }
  
  // Create style のクリックイベントリスナーを追加
  applyCreateStyleButton.addEventListener("click", function () {
    activateTab(tabs[1]);
    toggleTabContents(1);
    toggleTabContentAndResize(1);
  });

  // ボタンにクリックイベントリスナーを追加
  createStyleButton.addEventListener("click", function () {
    // スタイル名のインプット要素から値を取得
    const styleNameInput = document.getElementById("styleNameInput");
    const styleName = styleNameInput.value.trim();
    let fontFamilyJapanese = document.querySelector(
      '[data-lang="Japanese"] .font-family .create-style__dropdown-label'
    );
    let fontFamilyEnglish = document.querySelector(
      '[data-lang="English"] .font-family .create-style__dropdown-label'
    );
    const timestamp = new Date().toISOString().replace(/[^\d]/g, "");
    // styleName が空でないことを確認します
    if (!styleName) {
      alert("Please enter a style name.");
      return;
    }
    const newItem = document.createElement("li");
    newItem.classList.add("apply-style__item");
    newItem.setAttribute("data-env", `style-${timestamp}`);
    applyStyleNumber++; // applyStyleNumberをインクリメント
  
    // リストアイテムに追加するHTMLコンテンツを設定
    newItem.innerHTML = `
      <div class="apply-style__item-content">
        <h3 class="apply-style__item-title">${styleName}</h3>
      </div>
      <button
        class="options-button edit"
        tabindex="0"
        aria-label="その他のオプション"
        data-tooltip-type="text"
        data-tooltip="その他のオプション"
      >
        <span class="apply-style__options-svg-container">
          <svg
            class="apply-style__options-svg"
            width="32"
            height="32"
            viewBox="0 0 32 32"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M12 16.05V9H13V16.05C14.1411 16.2816 15 17.2905 15 18.5C15 19.7095 14.1411 20.7184 13 20.95V23H12V20.95C10.8589 20.7184 10 19.7095 10 18.5C10 17.2905 10.8589 16.2816 12 16.05ZM14 18.5C14 19.3284 13.3284 20 12.5 20C11.6716 20 11 19.3284 11 18.5C11 17.6716 11.6716 17 12.5 17C13.3284 17 14 17.6716 14 18.5ZM19 23H20V15.95C21.1411 15.7184 22 14.7095 22 13.5C22 12.2905 21.1411 11.2816 20 11.05V9H19V11.05C17.8589 11.2816 17 12.2905 17 13.5C17 14.7095 17.8589 15.7184 19 15.95V23ZM21 13.5C21 12.6716 20.3284 12 19.5 12C18.6716 12 18 12.6716 18 13.5C18 14.3284 18.6716 15 19.5 15C20.3284 15 21 14.3284 21 13.5Z"
            />
          </svg>
        </span>
      </button>
      <div class="popup edit">
        <div class="popup-arrow-container">
          <div class="popup-content">Edit style</div>
          <div class="popup-arrow">
            <svg
              width="13"
              height="7"
              viewBox="0 0 13 7"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path d="M6.5 0L13 6.5H0L6.5 0Z" fill="#222222" />
            </svg>
          </div>
        </div>
      </div>
      <button
        class="options-button delete"
        tabindex="0"
        aria-label="その他のオプション"
        data-tooltip-type="text"
        data-tooltip="その他のオプション"
      >
        <span class="apply-style__options-svg-container">
          <svg
            class="apply-style__options-svg"
            width="32"
            height="32"
            viewBox="0 0 32 32"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M15 9.5C14.4477 9.5 14 9.94772 14 10.5H18C18 9.94772 17.5523 9.5 17 9.5H15ZM19 10.5C19 9.39543 18.1046 8.5 17 8.5H15C13.8954 8.5 13 9.39543 13 10.5H11.5H10V11.5H11V21.5C11 22.6046 11.8954 23.5 13 23.5H19C20.1046 23.5 21 22.6046 21 21.5V11.5H22V10.5H20.5H19ZM20 11.5H18.5H13.5H12V21.5C12 22.0523 12.4477 22.5 13 22.5H19C19.5523 22.5 20 22.0523 20 21.5V11.5ZM14 18.5V14.5H15V18.5H14ZM17 18.5V14.5H18V18.5H17Z"
            />
          </svg>
        </span>
      </button>
  
      <div class="popup delete">
        <div class="popup-arrow-container">
          <div class="popup-content">Delete style</div>
          <div class="popup-arrow">
            <svg
              width="13"
              height="7"
              viewBox="0 0 13 7"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path d="M6.5 0L13 6.5H0L6.5 0Z" fill="#222222" />
            </svg>
          </div>
        </div>
      </div>
      <!-- その他のオプションボタンとポップアップ、メニューなどを含むHTMLをここに追加 -->
    `;
  
    // apply-style__listの要素に新しいリストアイテムを追加
    applyStyleList.appendChild(newItem);
  
    // 新しいリストアイテムに関するイベントをここで追加しています
    newItem.addEventListener("click", function (e) {
      // クリックイベントのバブリングを止める
      e.stopPropagation();
  
      // 他のアイテムのアクティブ状態を解除
      removeAllActiveItems();
      removeAllActiveButtons();
  
      // クリックされたアイテムにアクティブクラスを切り替え
      newItem.classList.toggle("active");
      selectedName = newItem.querySelector(
        ".apply-style__item-title"
      ).textContent; // スタイル名を取得
      selectedEnv = newItem.getAttribute("data-env"); // 環境を取得
      console.log("wow");
  
      // ボタンの状態を更新
      updateButtonState();
    });
    // 設定/編集ボタンに関するイベントリスナーをここで追加できます。
    const applyStyleEditButton = newItem.querySelector(
      ".options-button.edit"
    );
    const applyStyleDeleteButton = newItem.querySelector(
      ".options-button.delete"
    );
    applyStyleEditButton.addEventListener("click", function (e) {
      // イベントのバブリングを阻止
      e.stopPropagation();

      removeAllActiveButtons();

      // クリックされた要素がボタン自体ではなく子要素の場合、closestを使用してボタン要素を取得
      const buttonElement = e.target.closest(
        ".options-button"
      );

      // data-env 属性を持つ最も近い親要素を取得
      const parentItem = buttonElement.closest("[data-env]");
      // 親要素から data-env 属性の値を取得
      const dataEnvValue = parentItem ? parentItem.getAttribute('data-env') : null;
      // apply-style__item-title クラスを持つ要素を親要素から検索し、そのテキスト内容を取得
      const styleTitle = parentItem ? parentItem.querySelector('.apply-style__item-title').textContent : null;

      applyStylesContainer.classList.add("hidden");
      editStyleContainer.classList.remove("hidden");

      toggleTabContentAndResize(2);

      parent.postMessage(
        {
          pluginMessage: {
            type: "get-saved-style",
            key: dataEnvValue,
            styleName: styleTitle,
          },
        },
        "*"
      );

      // 他のアクティブな項目を非アクティブにする
      removeAllActiveItems();
    });
    applyStyleDeleteButton.addEventListener("click", function (e) {
          e.stopPropagation(); // イベントバブリングを防ぐ
          const envValue = newItem.getAttribute("data-env");
          let itemToDelete = document.querySelector(
            `.apply-style__item[data-env="${envValue}"]`
          ); // DOM 要素を取得
          if (itemToDelete) {
            itemToDelete.remove(); // DOM 要素を削除
          }
          parent.postMessage(
            {
              pluginMessage: {
                type: "delete-style",
                env: newItem.getAttribute("data-env"),
              },
            },
            "*"
          );
        });

  
    // フォントスタイル情報をそれぞれのドロップダウンから取得
    const japaneseFontFamily = document
      .querySelector('[data-lang="Japanese"] [data-label-type="font-family"]')
      .textContent.trim();
    const japaneseFontWeight = document
      .querySelector('[data-lang="Japanese"] [data-label-type="font-weight"]')
      .textContent.trim();
    const englishFontFamily = document
      .querySelector('[data-lang="English"] [data-label-type="font-family"]')
      .textContent.trim();
    const englishFontWeight = document
      .querySelector('[data-lang="English"] [data-label-type="font-weight"]')
      .textContent.trim();
  
    // 各言語のフォント設定を格納するオブジェクトを作成します
    const fontSettings = {
      Japanese: {
        fontFamily: japaneseFontFamily,
        fontWeight: japaneseFontWeight,
      },
      English: {
        fontFamily: englishFontFamily,
        fontWeight: englishFontWeight,
      },
    };
    // スタイル名とフォント設定をFigmaプラグインのメインコードに送信
    parent.postMessage(
      {
        pluginMessage: {
          type: "save-style",
          styleName: styleName,
          fontSettings: fontSettings,
          key: timestamp, // この部分はユーザーのIDや一意の識別子を使用
        },
      },
      "*"
    );
    styleNameInput.value = "";
    fontFamilyJapanese.textContent = "Noto Sans JP";
    fontFamilyEnglish.textContent = "SF Pro";
    activateTab(tabs[0]); //インジケータはないので、なくてもよいが一応残している
    toggleTabContents(0);
    toggleTabContentAndResize(0);
  });

  // Applyボタンの要素を取得し、デフォルトでは無効化する
  const applyBtn = document.getElementById("applyBtn");
  applyBtn.disabled = true; // 初期状態としてボタンを無効化
  // UIのHTML中のスクリプトは以下のようになります。
  // UIから送られるメッセージは、上記 figma.ui.onmessage でリッスンされます。
  // When the button is clicked, the plugin will start the text analysis and update
  applyBtn.addEventListener("click", () => {
    const cloneLayerName = `${layerName}_${selectedName}`;
    parent.postMessage(
      {
        pluginMessage: {
          type: "analyzeAndUpdateText",
          selectedStyleName: selectedName,
          key: selectedEnv,
          layerName: cloneLayerName,
        },
      },
      "*"
    );
  });
  
  // すべてのボタンのアクティブ状態を解除する関数
  function removeAllActiveButtons() {
    document
      .querySelectorAll(".options-button.active")
      .forEach((activeButton) => {
        activeButton.classList.remove("active");
      });
  }
  
  // すべてのアイテムのアクティブ状態を解除する関数
  function removeAllActiveItems() {
    document
      .querySelectorAll(".apply-style__item.active")
      .forEach((activeItem) => {
        activeItem.classList.remove("active");
      });
  }
  
  // ドキュメント全体のクリックイベントリスナーを追加
  document.addEventListener(
    "click",
    (e) => {
      // クリックが.apply-style__item or .apply-style__options-button要素の内部でなければアクティブクラスを削除
      if (
        !e.target.closest(".apply-style__item") ||
        !e.target.closest(".options-button")
      ) {
        // 他のアイテムのアクティブ状態を解除
        // removeShowMenu();
        removeAllActiveItems();
        removeAllActiveButtons();
        selectedEnv = null;
        // ボタンの状態を更新
        updateButtonState();
      }
    },
    false
  );
  
  // メニューを非表示にするための関数
  function hideMenu() {
    // Apply styles の menu を非表示にする
    document.querySelectorAll(".menu").forEach((menu) => {
      menu.style.display = "none";
    });
    // Create styles の font-style / font-weight menu を非表示にする
    document.querySelectorAll(".create-style__font-menu").forEach((menu) => {
      menu.classList.add("hidden");
    });
  
    // オーバーレイを非表示にする
    overlay.classList.add("hidden");
  
    // メニューが開いている状態クラスをbodyから削除
    document.body.classList.remove("menu-open");
  
    // すべてのアクティブなメニューボタンの状態をリセット
    const activeButtons = document.querySelectorAll(
      ".options-button.active"
    );
    activeButtons.forEach((button) => {
      button.classList.remove("active");
    });
  }
  
  // オーバーレイがクリックされた時にメニューを非表示にするイベントリスナーを追加
  overlay.addEventListener("click", hideMenu);
  
  // アイテムのクリックイベントを設定
  applyStyleItems.forEach((item) => {
    item.addEventListener("click", (e) => {
      // クリックイベントのバブリングを止める
      e.stopPropagation();
  
      // 他のアイテムのアクティブ状態を解除
      removeAllActiveItems();
      removeAllActiveButtons();
  
      // クリックされたアイテムにアクティブクラスを切り替え
      item.classList.toggle("active");
      selectedEnv = item.getAttribute("data-env"); // 環境を取得
  
      // ボタンの状態を更新
      updateButtonState();
    });
  });
  
  // Applyボタンの有効/無効ステータスを更新する関数
  function updateButtonState() {
    // selectedEnvがnullでないかをチェックして、isEnvSelectedを更新する
    isEnvSelected = selectedEnv !== null;
    // Applyボタンは環境が選択され、何かが選択されている場合のみ活性化する
    applyBtn.disabled = !(isEnvSelected && hasSelection);
  
    if (isEnvSelected && hasSelection) {
      applyBtn.classList.remove("disabled");
      applyBtn.classList.add("active");
    } else {
      applyBtn.classList.remove("active");
      applyBtn.classList.add("disabled");
    }
  }

  function setupSliders() {
    // すべてのスライダーを取得
    const sliders = document.querySelectorAll('.slider');
  
    sliders.forEach((slider) => {
      const thumb = slider.querySelector('.slider__thumb');
      const track = slider.querySelector('.slider__track');
      const tick = slider.querySelector('.slider__tick');
      const input = document.getElementById(slider.dataset.input); // データ属性を使用して関連するinput要素を取得
  
      // スライダーのthumbをドラッグ可能にする
      thumb.addEventListener('mousedown', (e) => {
        e.preventDefault();
        const rect = track.getBoundingClientRect();
  
        // ドラッグイベントを処理する関数
        const onMouseMove = (e) => {
          let newValue = (e.clientX - rect.left) / rect.width;
          newValue = Math.min(Math.max(newValue, 0), 1); // 0から1の範囲に制限する
          thumb.style.marginLeft = `${newValue * 100}%`;
          tick.style.marginLeft = `${newValue * 100}%`;
  
          // 対応するinput要素の値を更新
          if(input) {
            const value = (newValue * (input.max - input.min) + parseFloat(input.min)).toFixed(2);
            input.value = value;
  
            // inputに基づいてsample-style__textのスタイルを更新
            switch(input.id) {
              case 'scaleInput':
                sampleText.style.transform = `scale(${value})`;
                break;
              case 'xInput':
                sampleText.style.transform = `translateX(${value}px)`;
                break;
              case 'yInput':
                sampleText.style.transform = `translateY(${value}px)`;
                break;
            }
          }
        };
  
        // ドラッグ終了イベントを処理する関数
        const onMouseUp = () => {
          document.removeEventListener('mousemove', onMouseMove);
          document.removeEventListener('mouseup', onMouseUp);
          thumb.classList.add('slider__thumb--inactive'); // ドラッグ終了時にクラスを反映
        };
  
        thumb.classList.remove('slider__thumb--inactive'); // ドラッグ開始時にクラスを削除
        document.addEventListener('mousemove', onMouseMove);
        document.addEventListener('mouseup', onMouseUp);
      });
    });
  }
</script>
